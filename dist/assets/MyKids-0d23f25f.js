import{b7 as D,a as z,y as K,r as N,bm as I,$ as k,bK as V,j as e,aq as O,a0 as E,bn as X,bL as P,bM as J,B as M,T as Y,b4 as F,bN as G,as as T,D as y,E as U,ay as Q,I as b,L as R,bO as Z,bP as W,bQ as $,g as ee,bR as se,H as L,J as B,bS as _,M as q,x as ae}from"./index-7fa67d35.js";const le="/assets/blackPencilIcon-edfb207a.svg",te="/assets/dotIcon-aba1d670.svg",ne="/assets/kidmeme-d65732b3.svg",ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAATCAYAAACdkl3yAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFPSURBVHgB1ZPNUcMwEIVXAu6hA0pQKiCqAKggTgUk58DEQDIcSSoIqQB3IFwBSgeU4DsTibdxTGTjsX3NzvhntDuf3r6ViE46FsqoF2UGdTlBHYIBguSHJ+odljJHbvJodVLUyC4QlBlANlN7fcmPJ7eSAOe5jiCUrPFaARAXKw9WLwkwRxQVa+dtmB9yOrY6q0lZqIoaQa/KXO1IrAUJ5cl/L1SaQNFTWINWB2jR/umuQrhvR/ILkC3ka4AmmEiEacXHmnQG8292RMtiTVQhbCxVPCnXpDN8xrzJ1Gr7D8TtsJIQwirgwxCjHkF6BhVDvze4DCm15va7iCRUgnPC/xu0uTwcgT7M71chpZirT/OsTFSXi5XpUUvIY49+iz5VtYA9uch96wZCvMOP+7ky4xBCubGjNlBpajD39ozkW3inALlr9KQp+IaH9+g04xcE9omQu2qnugAAAABJRU5ErkJggg==",ie="/assets/redDeleteIcon-d81f5dcd.svg";function oe(a){return D({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M226.53,56.41l-96-32a8,8,0,0,0-5.06,0l-96,32A8,8,0,0,0,24,64v80a8,8,0,0,0,16,0V75.1L73.59,86.29a64,64,0,0,0,20.65,88.05c-18,7.06-33.56,19.83-44.94,37.29a8,8,0,1,0,13.4,8.74C77.77,197.25,101.57,184,128,184s50.23,13.25,65.3,36.37a8,8,0,0,0,13.4-8.74c-11.38-17.46-27-30.23-44.94-37.29a64,64,0,0,0,20.65-88l44.12-14.7a8,8,0,0,0,0-15.18ZM176,120A48,48,0,1,1,89.35,91.55l36.12,12a8,8,0,0,0,5.06,0l36.12-12A47.89,47.89,0,0,1,176,120ZM128,87.57,57.3,64,128,40.43,198.7,64Z"}}]})(a)}const pe=()=>{const[a]=z(K),[t,c]=N.useState(I),[n,{open:p,close:g}]=k(!1),[m,x]=N.useState(""),[l,d]=N.useState(""),[A,C]=N.useState(""),[h,v]=N.useState(""),{isLoading:o,refetch:j}=V();return console.log(t,"curr step"),e.jsx(e.Fragment,{children:e.jsxs(O.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:1},children:[e.jsxs(E,{padding:"xm ",opened:n,onClose:g,centered:!0,size:"lg",radius:10,withCloseButton:!1,children:[t===X&&e.jsx(ChildAgeModal,{onContinue:()=>c(P),goBack:()=>c(t-1),setAge:d}),t===P&&e.jsx(SelectAvatar,{onContinue:()=>c(J),goBack:()=>c(t-1),age:l,schoolName:h,userName:A,name:m,setAge:d,setName:x,setSchoolName:v,setUserName:C})]}),e.jsxs("div",{className:"px-4 ",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-[24px]  my-8 font-medium font-Hanken",children:"My Kids"}),e.jsx(M,{onClick:()=>{p(),c(I)},size:"md",children:e.jsxs("p",{className:"flex gap-2 py-1",children:[e.jsx("img",{loading:"lazy",src:ne,alt:"meme"}),e.jsx("span",{children:"Create new profile"})]})})]}),e.jsx("div",{className:"grid grid-cols-2 gap-y-10 gap-x-4",children:a.map((u,i)=>e.jsx(re,{refetch:j,...u,isLoading:o},i))})]})]})})},re=({image:a,name:t,dob:c,student:n,id:p,isLoading:g,refetch:m})=>{var f,s;const[x,{open:l,close:d}]=k(!1),[A,{open:C,close:h}]=k(!1),[v,{open:o,close:j}]=k(!1),u=c==null?void 0:c.split("-")[0],S=new Date().getFullYear()-Number(u);return e.jsxs(e.Fragment,{children:[e.jsx(E,{radius:10,size:"lg",px:"md",opened:x,onClose:d,withCloseButton:!1,centered:!0,children:e.jsx(me,{refetch:m,id:p,image:a,name:t,dob:c,closeModal:d})}),e.jsx(E,{radius:10,size:"lg",opened:v,onClose:j,withCloseButton:!1,centered:!0,children:e.jsx(xe,{profileId:p,closeModal:j})}),e.jsx(E,{radius:10,size:"md",px:"md",opened:A,onClose:h,withCloseButton:!1,centered:!0,children:e.jsx(de,{student:n,closeSchModal:h})}),e.jsxs("div",{className:" relative  lg:flex  border-[#FBECFF] border-[3px] px-6 py-6 rounded-3xl",children:[e.jsx("div",{className:" flex justify-center items-center",children:g?e.jsx("span",{children:e.jsx(Y,{height:100,circle:!0,mb:"xl"})}):e.jsx("img",{loading:"lazy",src:a,alt:"avatar",className:"w-avatar object-cover rounded-md"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h1",{className:"font-bold text-[16px] px-3 font-Hanken",children:t&&((f=t==null?void 0:t.charAt(0))==null?void 0:f.toUpperCase())+(t==null?void 0:t.slice(1))}),e.jsxs("p",{className:"text-gray-400 flex text2 mt-4 ",children:[e.jsxs("span",{className:"border-l-gray-600 border-r-2 mr-4 px-3 text-[14px] font-Hanken",children:["Age - ",S]}),e.jsxs("div",{children:[" ",(n==null?void 0:n.status)==="approved"?e.jsxs("button",{onClick:C,className:"text2 flex gap-1 justify-center items-center mt-1",children:[e.jsx(oe,{size:25,color:"#8530C1"}),e.jsxs("p",{className:"text2 text-[#8530C1] text-[14px] font-Hanken",children:[" ","View School Info"]})]}):(n==null?void 0:n.status)==="declined"?e.jsxs("button",{onClick:o,className:" mt-1 flex justify-center items-center gap-2 bg-[#FEF3F2] px-2 py-1 rounded-2xl",children:[e.jsx("p",{className:"h-2 w-2 rounded-full bg-[#F04438]"}),e.jsx("p",{className:"text2  text-[#B42318] text-[14px] font-Hanken",children:"Request declined"})]}):(n==null?void 0:n.status)==="pending"&&((s=n==null?void 0:n.school_name)==null?void 0:s.length)>0?e.jsxs("button",{className:"mt-1 flex justify-center items-center gap-2 bg-[#FFFAEB] px-2 py-1 rounded-2xl",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-[#F79009]"}),e.jsx("span",{className:"text2  text-[#B54708] text-[14px] font-Hanken",children:"Request Pending"})]}):e.jsxs("button",{onClick:o,className:"text2 flex gap-1 justify-center items-center  mt-1",children:[e.jsx("img",{loading:"lazy",src:ce,alt:"link icon"}),e.jsx("p",{className:"text2 text-[#8530C1]",children:"Connect to School"})]})]})]})]}),e.jsx("div",{className:"",children:e.jsxs(F,{children:[e.jsx(F.Target,{children:e.jsx("span",{className:"absolute  right-5 p-2 cursor-pointer",children:e.jsx("img",{loading:"lazy",src:te,alt:"doticon"})})}),e.jsx(F.Dropdown,{children:e.jsxs("div",{className:"flex flex-col absolute  bg-white top-[-40px]  w-52 left-3 py-4 rounded-2xl shadow-gray-400  box shadow-md ",children:[e.jsx(F.Item,{children:e.jsxs("button",{onClick:l,className:"p-2 px-4   flex gap-2  justify-start items-center",children:[e.jsx("img",{loading:"lazy",src:le,alt:"pencil icon"}),e.jsx("span",{className:"text3",children:"Edit profile"})]})}),e.jsx(F.Item,{children:e.jsxs("button",{className:"p-2 px-4  flex gap-2  justify-start items-center",children:[e.jsx("img",{loading:"lazy",src:ie,alt:"delete icon"}),e.jsx("span",{className:"text3",children:" Remove profile"})]})})]})})]})})]})]})},me=({id:a,image:t,name:c,dob:n,refetch:p,closeModal:g})=>{var S,f;const m=N.useRef(null),[x,l]=N.useState(),{isLoading:d,mutate:A}=G(),C=T(),h=s=>{const r=s.target.files,H=r&&r[0];l(H)},v=()=>{m!=null&&m.current&&m.current.click()},o=y.object({name:y.string().min(4,{message:"School name must be at least 4 characters long"}).max(40,{message:"School name must not exceed 20 characters"}),dob:y.string().optional(),file:y.string().url().optional()}),{register:j,handleSubmit:u,formState:{errors:i}}=U({resolver:L(o)}),w=async s=>{A({name:s.name,age:s.dob,image:x,profile_id:`${a}`},{onSuccess(r){B.show({title:"Notification",message:r.data.message}),C.invalidateQueries({queryKey:_.profiles}),p(),g()},onError(r){B.show({title:"Notification",message:q(r)})}})};return e.jsxs("div",{className:"px-5 py-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-center font-Recoleta font-bold text30  flex-grow",children:"Edit Profile"}),e.jsx(Q,{size:35,onClick:g,className:"cursor-pointer"})]}),e.jsxs("div",{className:"px-10",children:[e.jsxs("div",{className:"flex justify-between items-center ",children:[e.jsxs("p",{className:"flex gap-2 justify-end items-center",children:[e.jsx("img",{loading:"lazy",src:x?URL.createObjectURL(x):t,alt:"Avatar",className:"h-[100px] w-[100px]  object-cover"}),e.jsx("span",{className:"text3",children:"Profile Picture"})]}),e.jsx("button",{onClick:v,className:"text-blue-400 text3",children:"Upload picture"})]}),e.jsx("div",{children:e.jsxs("form",{onSubmit:u(w),children:[e.jsx("input",{type:"file",ref:m,style:{display:"none"},onChange:h}),e.jsxs("p",{className:"my-2 mt-4",children:[e.jsx("label",{htmlFor:"name",className:"text3 text-[#7E7E89]",children:"Name"}),e.jsx(b,{type:"text",reg:j("name"),errorMsg:i&&((S=i==null?void 0:i.name)==null?void 0:S.message),value:c})]}),e.jsx("p",{className:"my-2 flex gap-4",children:e.jsxs("p",{className:" flex-grow",children:[e.jsx("label",{htmlFor:"dob",className:"text3 text-[#7E7E89]",children:"DOB"}),e.jsx(b,{type:"date",reg:j("dob"),errorMsg:i&&((f=i==null?void 0:i.dob)==null?void 0:f.message),value:n})]})}),e.jsx("p",{className:"my-5",children:e.jsx(M,{type:"submit",children:d?e.jsx("p",{className:"flex justify-center items-center",children:e.jsx(R,{color:"white",size:"sm"})}):e.jsx("span",{className:"text2",children:"Save"})})})]})})]})]})},xe=({closeModal:a,profileId:t})=>{var u,i,w,S,f;const{mutate:c,isLoading:n}=Z(),[p,g]=N.useState(""),m=W(p,500),{data:x}=$(m),l=(u=x==null?void 0:x.data)==null?void 0:u.data,[d]=z(ee),A=T(),C=y.object({firstname:y.string().min(2,{message:"First name must be at least 2 characters long"}).max(40,{message:"First name must not exceed 20 characters"}),lastname:y.string().min(2,{message:"Last name must be at least 2 characters long"}).max(40,{message:"Last name must not exceed 20 characters"}),classid:y.string().min(1,{message:"Select a class"}).max(20,{message:"invalid class id"})}),{register:h,handleSubmit:v,formState:{errors:o}}=U({resolver:L(C)}),j=async s=>{c({profile_id:Number(t),firstname:s.firstname,lastname:s.lastname,school_id:l==null?void 0:l.id,class_id:Number(s==null?void 0:s.classid)},{onSuccess(r){ae("connect_to_school",{user_id:d==null?void 0:d.user_id,profile_id:sessionStorage.getItem("profileId"),student_name:(s==null?void 0:s.firstname)+" "+(s==null?void 0:s.lastname)}),a(),A.invalidateQueries({queryKey:_.profiles}),B.show({title:"Notification",message:r.data.message})},onError(r){B.show({title:"Notification",message:q(r)})}})};return e.jsxs("div",{className:"px-4",children:[e.jsxs("div",{className:"flex justify-between items-center  ",children:[e.jsx("h1",{className:"text-center font-Recoleta font-bold text-[30px] flex-grow ",children:"Connect to school"}),e.jsx(Q,{size:35,onClick:a,className:"cursor-pointer"})]}),e.jsx("p",{className:"text-center my-5",children:"Connect your child to his/her school to enjoy..."}),e.jsx("div",{className:"px-10",children:e.jsxs("form",{onSubmit:v(j),children:[e.jsx("p",{className:"my-5",children:e.jsx(b,{reg:h("firstname"),errorMsg:(i=o==null?void 0:o.firstname)==null?void 0:i.message,type:"text",placeholder:"First name"})}),e.jsx("p",{className:"my-5",children:e.jsx(b,{reg:h("lastname"),errorMsg:(w=o==null?void 0:o.lastname)==null?void 0:w.message,type:"text",placeholder:"Last name"})}),e.jsx("p",{className:"my-5",children:e.jsx(b,{onChange:s=>g(s.target.value),value:p,type:"text",placeholder:"School Code"})}),e.jsx("p",{className:"my-5",children:e.jsx("p",{className:"border border-[#F3DAFF] py-2 px-8 rounded-full flex items-center gap-2 mt-2  mb-2 ",children:l!=null&&l.name?l==null?void 0:l.name:"School Name"})}),e.jsx("p",{className:"my-5",children:e.jsx("p",{className:"border border-[#F3DAFF] py-3 px-8 rounded-full flex items-center gap-2 mt-2  mb-2 ",children:e.jsxs("select",{...h("classid"),name:"classid",id:"classid",className:"w-full  h-full flex-1  focus:outline-none text-[14px]",children:[e.jsx("option",{value:"",children:"Select class"}),((S=l==null?void 0:l.classes)==null?void 0:S.length)>0&&((f=l==null?void 0:l.classes)==null?void 0:f.map((s,r)=>e.jsx("option",{value:s.id,children:s.name},r)))]})})}),e.jsx("p",{className:"my-5",children:e.jsx(M,{type:"submit",children:n?e.jsx("p",{className:"flex justify-center items-center",children:e.jsx(R,{color:"white",size:"sm"})}):e.jsx("span",{children:"Continue"})})})]})})]})},de=({student:a,closeSchModal:t})=>e.jsxs("div",{className:"px-10",children:[e.jsxs("div",{className:"flex  justify-between items-center",children:[e.jsx("p",{className:"text25 text-center font-semibold flex-grow ",children:"School information"}),e.jsx("button",{onClick:t,children:e.jsx(se,{size:25})})]}),e.jsxs("p",{className:"my-5",children:[e.jsx("label",{htmlFor:"school",children:"School"}),e.jsx(b,{value:a==null?void 0:a.school_name,type:"text",readonly:!0,placeholder:"First name"})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"my-5",children:[e.jsx("label",{htmlFor:"school",children:"Class"}),e.jsx(b,{value:a==null?void 0:a.class_name,type:"text",readonly:!0,placeholder:"First name"})]}),e.jsxs("p",{className:"my-5",children:[e.jsx("label",{htmlFor:"school",children:"Teacher"}),e.jsx(b,{value:a==null?void 0:a.assigned_teacher_name,type:"text",readonly:!0,placeholder:"First name"})]})]})]});export{pe as default};
