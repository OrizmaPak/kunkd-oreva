var Te=(s,o,e)=>{if(!o.has(s))throw TypeError("Cannot "+e)};var n=(s,o,e)=>(Te(s,o,"read from private field"),e?e.call(s):o.get(s)),E=(s,o,e)=>{if(o.has(s))throw TypeError("Cannot add the same private member more than once");o instanceof WeakSet?o.add(s):o.set(s,e)},F=(s,o,e,i)=>(Te(s,o,"write to private field"),i?i.call(s,e):o.set(s,e),e);var b=(s,o,e)=>(Te(s,o,"access private method"),e);import{r,j as t,bF as Oe,cp as ht,cq as mt,cr as Qe,cs as ft,$ as Ve,a as Me,g as Fe,ct as gt,cu as pt,d as xt,f as $e,a0 as Ye,bh as bt,bi as yt,T as De,l as vt,k as St,bg as Ct,cv as Et,cw as jt,m as Ge,bl as We,cx as Nt,cy as wt,cz as kt,cA as Xe,cB as Je,cC as Ke,cD as Pt,cE as Lt,cF as At,cG as It,cH as _t,ac as Rt,J as Y,M as re,x as Ze}from"./index-7fa67d35.js";import{S as et}from"./Slider-1f935c81.js";import{S as Mt}from"./StoriesNav-d72f1143.js";import{T as Ft,C as Tt,a as Dt}from"./TabInReadingPage-f60bc204.js";import"./nexticon-3dad45ac.js";import"./videoicon-372ef70a.js";const tt=/[^\P{P}'/-]+/gu,zt=s=>typeof s=="string"||typeof s=="number",Ht=s=>s.replace(tt,""),Bt=s=>{const o=s.trim();return tt.test(o)&&o.length===1};var j=function(s){return s.BOUNDARY="boundary",s.END="end",s.ERROR="error",s.PAUSED="paused",s.PITCH="pitch",s.PLAYING="playing",s.RATE="rate",s.READY="ready",s.VOLUME="volume",s}(j||{}),c,p,X,me,V,G,U,oe,fe,le,ve,Ne,st,ge,ze,J,he,pe,He,ce,Se,xe,Be,be,Ue,we,nt,ke,it,Pe,at,ue,Ce,Le,rt,Ae,ot,de,Ee,Ie,lt,_e,ct,Re,ut;class Ut extends EventTarget{constructor(e){super();E(this,le);E(this,Ne);E(this,ge);E(this,J);E(this,pe);E(this,ce);E(this,xe);E(this,be);E(this,we);E(this,ke);E(this,Pe);E(this,ue);E(this,Le);E(this,Ae);E(this,de);E(this,Ie);E(this,_e);E(this,Re);E(this,c,void 0);E(this,p,void 0);E(this,X,!0);E(this,me,async()=>({audio:"",marks:[]}));E(this,V,[]);E(this,G,"");E(this,U,"");E(this,oe,new AbortController);E(this,fe,!1);F(this,U,(e==null?void 0:e.lang)??n(this,U)),F(this,p,window.speechSynthesis),F(this,c,new SpeechSynthesisUtterance(n(this,G))),F(this,X,(e==null?void 0:e.dispatchBoundaries)??n(this,X)),e!=null&&e.fetchAudioData?(F(this,c,F(this,p,new Audio)),F(this,me,e.fetchAudioData)):(b(this,le,ve).call(this,e==null?void 0:e.voice),window.speechSynthesis&&(window.speechSynthesis.onvoiceschanged=()=>{b(this,le,ve).call(this,e==null?void 0:e.voice)}))}get synthesizer(){return n(this,p)}get target(){return n(this,c)}set text(e){F(this,G,e),n(this,c)instanceof SpeechSynthesisUtterance&&(n(this,c).text=e)}get paused(){return n(this,p).paused}get rate(){return n(this,p)instanceof HTMLAudioElement?n(this,p).playbackRate:n(this,c).rate}set rate(e){const i=b(this,de,Ee).call(this,parseFloat(e.toPrecision(3)),.1,10);Number.isNaN(i)||(b(this,ke,it).call(this,i),n(this,p)instanceof HTMLAudioElement&&(n(this,p).defaultPlaybackRate=i,n(this,p).playbackRate=i),n(this,c)instanceof SpeechSynthesisUtterance&&(n(this,c).rate=i))}get pitch(){return n(this,c)instanceof SpeechSynthesisUtterance?n(this,c).pitch:-1}set pitch(e){if(n(this,c)instanceof SpeechSynthesisUtterance){const i=b(this,de,Ee).call(this,parseFloat(e.toPrecision(2)),0,2);Number.isNaN(i)||(b(this,Pe,at).call(this,i),n(this,c).pitch=i)}}get volumeMin(){return 0}get volumeMax(){return 1}get volume(){return n(this,c).volume}set volume(e){const i=b(this,de,Ee).call(this,parseFloat(e.toPrecision(2)),this.volumeMin,this.volumeMax);Number.isNaN(i)||(b(this,we,nt).call(this,i),n(this,c).volume=i)}get preservesPitch(){return n(this,p)instanceof HTMLAudioElement?n(this,p).preservesPitch:!1}set preservesPitch(e){n(this,p)instanceof HTMLAudioElement&&(n(this,p).preservesPitch=e)}get lang(){return n(this,U)}set lang(e){n(this,c)instanceof SpeechSynthesisUtterance&&(F(this,U,e),n(this,c).lang=e,n(this,c).voice=null,b(this,le,ve).call(this))}async init(){n(this,fe)||(n(this,c)instanceof SpeechSynthesisUtterance&&b(this,_e,ct).call(this),n(this,c)instanceof HTMLAudioElement&&await b(this,Re,ut).call(this),F(this,fe,!0))}async play(){n(this,p)instanceof HTMLAudioElement?await b(this,ue,Ce).call(this):n(this,p).speak(n(this,c))}pause(){n(this,p).pause()}async resume(){n(this,p)instanceof HTMLAudioElement?await b(this,ue,Ce).call(this):n(this,p).resume()}async replay(){n(this,p)instanceof HTMLAudioElement?(n(this,p).load(),await b(this,ue,Ce).call(this)):(n(this,p).resume(),n(this,p).cancel(),n(this,p).speak(n(this,c)))}cancel(){n(this,p)instanceof HTMLAudioElement?n(this,p).load():n(this,p).cancel()}mute(){this.volume=0,!(n(this,p)instanceof HTMLAudioElement)&&!this.paused&&n(this,p).speaking&&this.replay()}unmute(e){this.volume=e??1,!(n(this,p)instanceof HTMLAudioElement)&&!this.paused&&n(this,p).speaking&&this.replay()}}c=new WeakMap,p=new WeakMap,X=new WeakMap,me=new WeakMap,V=new WeakMap,G=new WeakMap,U=new WeakMap,oe=new WeakMap,fe=new WeakMap,le=new WeakSet,ve=function(e){if(n(this,c)instanceof SpeechSynthesisUtterance){let i=window.speechSynthesis.getVoices();e&&(n(this,c).voice=e),n(this,U)&&(i=i.filter(l=>l.lang===n(this,U)),n(this,c).voice=i[0]??null,e&&e.lang===n(this,U)&&(n(this,c).voice=e))}},Ne=new WeakSet,st=async function(){if(n(this,p)instanceof HTMLAudioElement){let e=null;try{e=await n(this,me).call(this,n(this,G))}catch(i){i instanceof Error&&b(this,J,he).call(this,i.message)}finally{e!=null&&e.audio&&(n(this,p).src=e.audio,F(this,V,e.marks??n(this,V)))}}},ge=new WeakSet,ze=function(e){this.dispatchEvent(new CustomEvent(j.END,{detail:e}))},J=new WeakSet,he=function(e){this.dispatchEvent(new CustomEvent(j.ERROR,{detail:e}))},pe=new WeakSet,He=function(){this.dispatchEvent(new Event(j.READY))},ce=new WeakSet,Se=function(e){this.dispatchEvent(new CustomEvent(j.PLAYING,{detail:e}))},xe=new WeakSet,Be=function(e){this.dispatchEvent(new CustomEvent(j.PAUSED,{detail:e}))},be=new WeakSet,Ue=function(e,i){this.dispatchEvent(new CustomEvent(j.BOUNDARY,{detail:{evt:e,boundary:i}}))},we=new WeakSet,nt=function(e){this.dispatchEvent(new CustomEvent(j.VOLUME,{detail:e}))},ke=new WeakSet,it=function(e){this.dispatchEvent(new CustomEvent(j.RATE,{detail:e}))},Pe=new WeakSet,at=function(e){this.dispatchEvent(new CustomEvent(j.PITCH,{detail:e}))},ue=new WeakSet,Ce=async function(){const e=n(this,p);try{await e.play()}catch(i){i instanceof Error&&b(this,J,he).call(this,i.message)}},Le=new WeakSet,rt=function(e){const i=n(this,V).length;let l=n(this,V)[0],d=!1,C=1;for(;C<i&&!d;)n(this,V)[C].time<=e?l=n(this,V)[C]:d=!0,C++;return l},Ae=new WeakSet,ot=function(e){const i=n(this,G).substring(e).match(/.+?\b/);return i?i[0].length:0},de=new WeakSet,Ee=function(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(i,Math.min(e,l))},Ie=new WeakSet,lt=function(){return n(this,oe).abort(),F(this,oe,new AbortController),n(this,oe).signal},_e=new WeakSet,ct=function(){if(n(this,c)instanceof SpeechSynthesisUtterance){const e=b(this,Ie,lt).call(this);n(this,c).addEventListener("end",b(this,ge,ze).bind(this),{signal:e}),n(this,c).addEventListener("start",b(this,ce,Se).bind(this),{signal:e}),n(this,c).addEventListener("resume",b(this,ce,Se).bind(this),{signal:e}),n(this,c).addEventListener("pause",b(this,xe,Be).bind(this),{signal:e}),n(this,c).addEventListener("error",i=>{b(this,J,he).call(this,i.error)},{signal:e}),n(this,U)&&(n(this,c).lang=n(this,U)),n(this,X)&&n(this,c).addEventListener("boundary",i=>{const{charIndex:l}=i,d=i.charLength??b(this,Ae,ot).call(this,l),C=l+d,y=n(this,G).substring(l,C);y&&!Bt(y)&&b(this,be,Ue).call(this,i,{word:y,startChar:l,endChar:C})},{signal:e}),b(this,pe,He).call(this)}},Re=new WeakSet,ut=async function(){if(n(this,c)instanceof HTMLAudioElement){const e=n(this,c);n(this,c).addEventListener("canplay",b(this,pe,He).bind(this),{once:!0}),n(this,c).addEventListener("playing",b(this,ce,Se).bind(this)),n(this,c).addEventListener("pause",b(this,xe,Be).bind(this)),n(this,c).addEventListener("ended",b(this,ge,ze).bind(this)),n(this,c).addEventListener("error",()=>{const i=e.error;b(this,J,he).call(this,i==null?void 0:i.message)}),n(this,X)&&n(this,c).addEventListener("timeupdate",i=>{const l=e.currentTime*1e3,d=b(this,Le,rt).call(this,l);d&&!this.paused&&b(this,be,Ue).call(this,i,{word:d.value,startChar:d.start,endChar:d.end})}),await b(this,Ne,st).call(this)}};const Ot=s=>{let{color:o,backgroundColor:e}=s;return{color:o,backgroundColor:e}},$t=s=>{let{text:o,mark:e,color:i,backgroundColor:l}=s;const d=r.useMemo(()=>Ot({color:i,backgroundColor:l}),[i,l]);if(o&&e){const C=o.toString(),y=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),h=new RegExp(`(${y})`,"gi"),f=C.split(h);if(f.length>1)return t.jsx("span",{children:f.map((v,x)=>{const N=`${v}-${x}`;return v?h.test(v)?t.jsx("mark",{style:d,children:v},N):t.jsx("span",{children:v},N):null})})}return t.jsx(t.Fragment,{children:o})},dt=s=>{let{children:o,buffer:e,boundary:i,markColor:l,markBackgroundColor:d,markTextAsSpoken:C}=s;return r.Children.map(o,y=>{let h=y;if(r.isValidElement(y)&&(h=r.cloneElement(y,{...y.props,children:dt({buffer:e,boundary:i,markColor:l,markBackgroundColor:d,markTextAsSpoken:C,children:y.props.children})})),zt(y)){const f=y.toString(),{word:v,startChar:x,endChar:N}=i,g=e.text.length;if(e.text+=`${f} `,C&&v){const P=x-g,A=N-g,_=f.substring(0,P),R=f.substring(P,A),M=f.substring(A,f.length);if(R)return t.jsxs(t.Fragment,{children:[_,t.jsx($t,{text:R,mark:Ht(R),color:l,backgroundColor:d}),M]})}}return h})},je={word:"",startChar:0,endChar:0},qt=(s,o)=>{switch(o.type){case"pause":return{...s,isPlaying:!1,isPaused:!0,isError:!1};case"play":case"reset":return{...s,isPlaying:!0,isPaused:!1,isError:!1,boundary:je};case"end":return{...s,isPlaying:!1,isPaused:!1,isError:!1,boundary:je};case"error":return{...s,isPlaying:!1,isPaused:!1,isError:!0,boundary:je};case"ready":return{...s,isReady:!0};case"boundary":return{...s,boundary:{...s.boundary,...o.payload}};case"voices":return{...s,voices:o.payload};case"stop":return{...s,isPlaying:!1,isPaused:!1,isError:!1};case"muted":return{...s,isMuted:!0};case"unmuted":return{...s,isMuted:!1}}},Vt=s=>{var qe;let{lang:o,rate:e,volume:i,voice:l,children:d,markColor:C,markBackgroundColor:y,onStart:h,onPause:f,onBoundary:v,onEnd:x,onError:N,onVolumeChange:g,onPitchChange:P,onRateChange:A,fetchAudioData:_,autoPlay:R=!1,markTextAsSpoken:M=!1}=s;const L=r.useRef(),[k,u]=r.useReducer(qt,{voices:((qe=window.speechSynthesis)==null?void 0:qe.getVoices())??[],boundary:je,isPlaying:!1,isPaused:!1,isMuted:!1,isError:!1,isReady:typeof _>"u"}),[W,T]=r.useMemo(()=>{if(typeof L.current>"u"||M){const m={text:""},B=dt({children:d,buffer:m,markColor:C,markBackgroundColor:y,markTextAsSpoken:M,boundary:k.boundary});return L.current=m.text.trim(),[B,L.current]}return[d,L.current]},[d,k.boundary,C,y,M]),a=r.useMemo(()=>new Ut({lang:o,voice:l,fetchAudioData:_}),[o,l,_]),I=r.useCallback(async()=>{k.isPaused?a.resume():a.replay(),u({type:"play"})},[a,k.isPaused]),O=r.useCallback(()=>{a.pause(),u({type:"pause"})},[a]),S=r.useCallback(()=>{a.replay(),u({type:"reset"})},[a]),D=r.useCallback(()=>{a.cancel(),u({type:"stop"})},[a]),K=r.useCallback(m=>{const B=parseFloat(a.volume.toFixed(2))===a.volumeMin;B?(a.unmute(),u({type:"unmuted"})):(a.mute(),u({type:"muted"})),typeof m=="function"&&m(B)},[a]),w=r.useMemo(()=>k.isPlaying?O:I,[k.isPlaying,O,I]),q=r.useMemo(()=>k.isPlaying?D:I,[k.isPlaying,D,I]),[z,ye]=r.useMemo(()=>[{lang(){return a.lang},rate(){return a.rate},pitch(){return a.pitch},volume(){return a.volume},preservesPitch(){return a.preservesPitch}},{lang(m){a.lang=m},rate(m){a.rate=m},pitch(m){a.pitch=m},volume(m){a.volume=m},preservesPitch(m){a.preservesPitch=m}}],[a]),Z=r.useCallback(m=>{u({type:"play"}),typeof h=="function"&&h(m.detail)},[h]),ee=r.useCallback(m=>{typeof f=="function"&&f(m.detail)},[f]),te=r.useCallback(m=>{u({type:"end"}),typeof x=="function"&&x(m.detail)},[x]),se=r.useCallback(()=>{u({type:"ready"})},[]),ne=r.useCallback(m=>{u({type:"error"}),typeof N=="function"&&N(m.detail)},[N]),ie=r.useCallback(m=>{u({type:"boundary",payload:m.detail.boundary}),typeof v=="function"&&v(m.detail.boundary,m.detail.evt)},[v]),ae=r.useCallback(m=>{const B=m.detail,Q=a.volumeMin;B===Q&&a.volume!==Q&&u({type:"muted"}),B!==Q&&a.volume===Q&&u({type:"unmuted"}),typeof g=="function"&&g(B)},[g,a]),H=r.useCallback(m=>{typeof P=="function"&&P(m.detail)},[P]),$=r.useCallback(m=>{typeof A=="function"&&A(m.detail)},[A]);return r.useEffect(()=>{a.text=T},[T,a]),r.useEffect(()=>{e&&Number.isFinite(e)&&(a.rate=e),i&&Number.isFinite(i)&&(a.volume=i)},[a,e,i]),r.useEffect(()=>{const m=()=>{a.cancel()};return(async()=>{a.addEventListener(j.PLAYING,Z),a.addEventListener(j.PAUSED,ee),a.addEventListener(j.END,te),a.addEventListener(j.ERROR,ne),a.addEventListener(j.READY,se),a.addEventListener(j.BOUNDARY,ie),a.addEventListener(j.VOLUME,ae),a.addEventListener(j.PITCH,H),a.addEventListener(j.RATE,$),window.addEventListener("beforeunload",m),await a.init()})(),()=>{window.removeEventListener("beforeunload",m),a.removeEventListener(j.PLAYING,Z),a.removeEventListener(j.PAUSED,ee),a.removeEventListener(j.END,te),a.removeEventListener(j.ERROR,ne),a.removeEventListener(j.READY,se),a.removeEventListener(j.BOUNDARY,ie),a.removeEventListener(j.VOLUME,ae),a.removeEventListener(j.PITCH,H),a.removeEventListener(j.RATE,$)}},[Z,ie,ee,te,se,ne,v,ae,H,$,a]),r.useEffect(()=>{R&&k.isReady&&(a.replay(),u({type:"play"}))},[R,a,k.isReady,T]),r.useEffect(()=>{var B;const m=()=>{u({type:"voices",payload:window.speechSynthesis.getVoices()})};return typeof((B=window.speechSynthesis)==null?void 0:B.addEventListener)=="function"&&window.speechSynthesis.addEventListener("voiceschanged",m),()=>{var Q;typeof((Q=window.speechSynthesis)==null?void 0:Q.removeEventListener)=="function"&&window.speechSynthesis.removeEventListener("voiceschanged",m)}},[]),{get:z,set:ye,state:k,spokenText:T,ttsChildren:W,play:I,stop:D,pause:O,replay:S,playOrStop:q,playOrPause:w,toggleMute:K}},Yt=({children:s,highlight:o=!0,setPageNumber:e,autoPlay:i,setPage:l,pageNumber:d,pageTotal:C,setIsFinish:y})=>{const{ttsChildren:h,play:f,pause:v,stop:x}=Vt({children:s,markTextAsSpoken:o,rate:.6,autoPlay:i,onEnd:()=>{e()}}),[N,g]=r.useState(!1),P=Oe();r.useEffect(()=>()=>{x()},[P.pathname]),r.useEffect(()=>{g(!1)},[d]);const A=_=>{l(_)};return t.jsxs("div",{children:[t.jsx("p",{className:" leading-10  h-[350px] overflow-y-auto  text-[16px] font-medium font-Hanken  text-justify ",children:h}),t.jsxs("div",{className:"flex gap-3 items-center",children:[N&&t.jsx("button",{className:"  py-1 px-8 rounded-3xl ",onClick:()=>{g(!1),f()},children:t.jsx(ht,{size:40,color:"#8530C1"})}),!N&&t.jsx("button",{className:"py-1 px-8 rounded-3xl ",onClick:()=>{g(!0),v()},children:t.jsx(mt,{size:40,color:"#8530C1"})}),t.jsxs("div",{className:"flex-grow pt-4 ",children:[t.jsx(Qe,{theme:{colors:{"ocean-blue":["#8530c1","#5FCCDB","#44CADC","#2AC9DE","#1AC2D9","#11B7CD","#09ADC3","#0E99AC","#128797","#147885"]}},children:t.jsx(et,{onChange:A,color:"ocean-blue.0",value:d,max:C,min:1,styles:{markLabel:{display:"none"}}})}),t.jsxs("p",{className:"text-center text2",children:[t.jsx("span",{children:d})," of ",t.jsx("span",{children:C})]})]}),d===C&&t.jsx(t.Fragment,{children:t.jsx("button",{onClick:y,className:" bg-green-600 rounded-3xl text-white py-3 px-8",children:"Finish"})})]})]})},Gt=(s,o,e)=>{const[i,l]=r.useState(!0),d=Oe(),{mutateAsync:C}=ft();return r.useEffect(()=>{let y,h=0;const f=()=>{const x=setInterval(()=>{h=h+1},1e3);return()=>clearInterval(x)},v=()=>{document.hidden?(l(!1),y()):(l(!0),y=f())};return document.addEventListener("visibilitychange",v),y=f(),()=>{C({content_id:s,profile_id:o,timespent:h,sub_category_id:e}).then(x=>x).catch(x=>x),document.removeEventListener("visibilitychange",v),y()}},[i,d]),null},as=()=>{var ye,Z,ee,te,se,ne,ie,ae;const[s,o]=r.useState(!1),[e,i]=r.useState(!1),l=sessionStorage.getItem("contentId"),d=sessionStorage.getItem("profileId"),C=Oe(),[y,{open:h,close:f}]=Ve(!1),[v,{open:x,close:N}]=Ve(!1),[g]=Me(Fe),P=(g==null?void 0:g.role)==="user",A=l==null?void 0:l.toString(),_=(d==null?void 0:d.toString())||"0",R=gt(P,A,_,h,x),M=pt(P,A,h),{data:L,isLoading:k}=P?R:M,u=L==null?void 0:L.data.data,[W,T]=r.useState(0);r.useEffect(()=>{var H;u&&((H=u.sub_categories)==null||H.map($=>{T($==null?void 0:$.sub_category_id)}))},[u]),Gt(Number(l),Number(d),W);const I=!!new URLSearchParams(C.search.split("?")[1]).get("from"),{data:O,isLoading:S}=xt(),D=O==null?void 0:O.data.data.recommended_stories,K=$e(),w=r.useRef(null),q=L??!1,z=((ye=q==null?void 0:q.data)==null?void 0:ye.status)!==!1||((Z=q==null?void 0:q.data)==null?void 0:Z.message)!=="Number of allowed contents reached!";return t.jsxs(t.Fragment,{children:[t.jsx(Ye,{radius:10,padding:30,size:"md",opened:y,onClose:f,overlayProps:{blur:10},closeOnClickOutside:!1,withCloseButton:!1,centered:!0,children:t.jsx(Ft,{onCancel:f})}),t.jsx(Ye,{radius:10,padding:30,size:"md",opened:v,onClose:N,overlayProps:{blur:10},closeOnClickOutside:!1,withCloseButton:!1,centered:!0,children:t.jsx(Tt,{onCancel:N})}),t.jsx(bt,{bgColor:"#fff7fd",children:t.jsx(yt,{children:t.jsx("div",{className:" bg-[#fff7fd]",children:t.jsxs("div",{className:"min-h-[calc(92vh-60px)] h-[100%] flex flex-col   ",children:[t.jsx("div",{className:" ",children:t.jsx(De,{visible:k,children:t.jsx(Mt,{category:"Stories",genre:u&&((te=(ee=u==null?void 0:u.sub_categories)==null?void 0:ee[0])==null?void 0:te.sub_category_name),title:u&&u.name,subCategoryId:u&&((ne=(se=u==null?void 0:u.sub_categories)==null?void 0:se[0])==null?void 0:ne.sub_category_id),slug:u&&((ae=(ie=u==null?void 0:u.sub_categories)==null?void 0:ie[0])==null?void 0:ae.sub_category_name)})})}),t.jsx("div",{className:"flex-grow  h-full   ",children:t.jsx("div",{className:"flex-grow mt-5 rounded-2xl ",children:s?t.jsx(Jt,{content:u}):t.jsxs("div",{className:"flex h-full  gap-4  flex-grow-1 flex-col ",children:[!e&&!I?t.jsx(De,{visible:k,children:t.jsx(Wt,{story:u,setStartRead:()=>i(!0)})}):null,k?t.jsx(De,{visible:k,height:700}):t.jsx(t.Fragment,{children:u&&(e||I)&&z&&t.jsx(Qt,{thumbnail:u.thumbnail,content:u.pages,setIsFinish:()=>o(!0),divRef:w})}),t.jsx(Dt,{}),t.jsxs("div",{className:"w-full bg-white rounded-3xl mt-4",children:[t.jsx(t.Fragment,{}),t.jsx(vt,{data:D,isLoading:S,header:"Recommended For You",isTitled:!1,card:H=>t.jsx(St,{...H,goTo:()=>{var $;K(`../stories/${H==null?void 0:H.theme}/${($=H.slug)==null?void 0:$.toLowerCase()}`),i(!1)}})})]})]})})})]})})})})]})},Wt=({story:s,setStartRead:o})=>{const e=sessionStorage.getItem("profileId"),{data:i,refetch:l}=Ct(e),d=i==null?void 0:i.data.data.records,{mutate:C}=Et(),{mutate:y}=jt(),h=d==null?void 0:d.filter(g=>g.id===(s==null?void 0:s.id)),f=()=>{N(),(h==null?void 0:h.length)===0||h===void 0?C({content_id:Number(s.id),profile_id:Number(e)},{onSuccess(){l(),Y.show({title:"Notification",message:(s==null?void 0:s.name)+" added to list"})},onError(g){Y.show({title:"Notification",message:re(g)})}}):y({content_id:Number(s==null?void 0:s.id),profile_id:Number(e)},{onSuccess(){l(),Y.show({title:"Notification",message:(s==null?void 0:s.name)+" removed from the list"})},onError(g){Y.show({title:"Notification",message:re(g)})}})},[v,x]=r.useState(!1),N=()=>{x(!0),setTimeout(()=>{x(!1)},200)};return t.jsxs("div",{className:"bg-[#5D0093]  w-[100%] flex rounded-3xl pad-x-40 about-card-px py-5",children:[t.jsxs("div",{className:"flex basis-full  border-r-2 justify-center items-center border-[#BD6AFA]  ",children:[t.jsx("p",{className:"flex flex-col w-full",children:s?t.jsx(Ge.LazyLoadImage,{src:s==null?void 0:s.thumbnail,placeholderSrc:We,effect:"blur",className:"rounded-2xl about-img ",wrapperClassName:"about-img"}):t.jsx(Ge.LazyLoadImage,{placeholderSrc:We,effect:"blur",className:"rounded-2xl about-img ",wrapperClassName:"about-img"})}),t.jsxs("p",{className:"grid flex-col w-full   h-full py-2 ",children:[t.jsx("span",{className:"font-bold font-Recoleta text-white text25 justify-self-start",children:s==null?void 0:s.name}),t.jsx("span",{className:" text-[#BD6AFA]  ",children:"Dele and Louisa Olafuyi"}),t.jsxs("p",{className:"  flex gap-1 ",children:[t.jsx("button",{onClick:g=>{g.stopPropagation(),o()},className:" py-3 px-10 inline self-end text-white border-white border-[2px] rounded-2xl",children:"Read"}),t.jsxs("button",{onClick:f,className:`px-4 py-2 rounded-md transition-all inline self-end items-center     ${v?"scale-150":""}`,children:[(h==null?void 0:h.length)>0?t.jsx(Nt,{size:"35",color:"white",className:" scale-110"}):t.jsx(wt,{size:"35",color:"white"}),t.jsx("style",{children:`
            @keyframes shake {
  0%, 100% {
    transform: translateX(0);
  }
  10%, 30%, 50%, 70%, 90% {
    transform: translateX(-10px);
  }
  20%, 40%, 60%, 80% {
    transform: translateX(10px);
  }
}

.animate-shake {
  animation: shake 0.3s infinite;
}`})]})]})]})]}),t.jsx("div",{className:" basis-3/4 text-[#BD6AFA] pad-x-40",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-white font-bold  font-Hanken text25 my-2",children:"Overview"}),t.jsx("p",{dangerouslySetInnerHTML:{__html:`${s==null?void 0:s.synopsis}`}})]})})]})},Qt=({content:s,setIsFinish:o,thumbnail:e,divRef:i})=>{var S,D,K;const[l,d]=r.useState(!1);console.log(d);const[C,y]=r.useState(0),h=(s==null?void 0:s.length)-1,[f,v]=r.useState(0),x=kt(),[N,g]=r.useState(25),P=w=>{g(w)},A=35,{mutate:_}=Xe(),{mutate:R}=Je(),{mutate:M}=Ke(),L=sessionStorage.getItem("profileId"),k=sessionStorage.getItem("contentId"),W=!!new URLSearchParams(location.search.split("?")[1]).get("from"),[T]=Me(Fe);r.useEffect(()=>{const w=new AbortController;return(async()=>{try{W?M({profile_id:Number(L),summer_challenge_quiz_id:Number(sessionStorage.getItem("summerQuizId")),content_id:Number(k),status:`${f===h?"complete":"ongoing"}`,pages_read:Number(f+1)},{onSuccess(z){return z},onError(z){Y.show({title:"Notification",message:re(z)})}}):(T==null?void 0:T.role)==="user"?_({profile_id:Number(L),content_id:Number(k),status:`${f===h?"complete":"ongoing"}`,pages_read:Number(f+1),timespent:23,signal:w.signal},{onSuccess(z){return z},onError(){}}):R({content_id:Number(k),status:`${f===h?"complete":"ongoing"}`,pages_read:Number(f+1),timespent:23,signal:w.signal},{onSuccess(z){return z},onError(){}})}catch{}})(),()=>{w.abort()}},[f]);const[a,I]=r.useState(!1);r.useEffect(()=>{const w=document.getElementById("container");a?w==null||w.requestFullscreen():document!=null&&document.exitFullscreen&&(document==null||document.exitFullscreen())},[a]);function O(w){return w===null||w===""?!1:(w=w.toString(),w.replace(/(<([^>]+)>)/gi,""))}return t.jsx(t.Fragment,{children:s?t.jsxs("div",{id:"container",className:`flex py-16  rounded-3xl px-10 justify-center items-center bg-white  ${a?"md:px-[50px] lg:px-[100px] ":""}`,children:[t.jsx("div",{className:" basis-3/4 flex  items-center  max-h-[500px] ",children:t.jsx("img",{loading:"lazy",src:((S=s[C])==null?void 0:S.image)||e,alt:"image",className:"read-img rounded-xl"})}),t.jsxs("div",{className:" basis-full flex flex-col  ",children:[t.jsxs("div",{className:"flex-grow",children:[t.jsxs("p",{className:"mb-5 flex justify-between items-center ",children:[t.jsxs("p",{className:"w-[200px] flex items-center gap-2 ",children:[t.jsx("strong",{children:"A-"}),t.jsx(Qe,{theme:{colors:{"ocean-blue":["#8530c1","#5FCCDB","#44CADC","#2AC9DE","#1AC2D9","#11B7CD","#09ADC3","#0E99AC","#128797","#147885"]}},children:t.jsx(et,{className:"w-full",color:"ocean-blue.0",value:N,onChange:P,min:20,max:A,disabled:x,size:"lg"})}),t.jsx("strong",{children:"A+"})]}),t.jsx("p",{className:"cursor-pointer",children:a?t.jsx(Pt,{color:"#8530C1",size:35,onClick:()=>{I(w=>!w)}}):t.jsx(Lt,{color:"#8530C1",size:35,onClick:()=>{I(w=>!w)}})})]}),!l&&t.jsx("p",{style:{fontSize:`${N}px`},ref:i,className:` leading-10 flex  ${a?"h-[450px]":"h-[350px]"}   overflow-y-auto  ${N+"px"} font-medium font-Hanken pr-8 text-justify `,children:t.jsx("p",{className:"content_cont leading-10 [&>img]:hidden text-center",dangerouslySetInnerHTML:{__html:(D=s[C])==null?void 0:D.web_body}})})]}),t.jsx("div",{className:"mt-8",children:l?t.jsx(Yt,{setIsFinish:o,pageNumber:f,pageTotal:h,autoPlay:!0,setPage:v,setPageNumber:()=>{f!==h&&v(w=>w+1)},highlight:!0,children:t.jsx("p",{style:{fontSize:`${N}px`},className:"content_cont leading-10  [&>img]:hidden text-center",children:At(O((K=s[f])==null?void 0:K.web_body))})}):t.jsx(Xt,{setIsFinish:o,setPage:y,pageTotal:h,setPageNumber:v,divRef:i})})]})]}):""})},Xt=({setIsFinish:s,setPage:o,pageTotal:e,setPageNumber:i,divRef:l})=>{const{mutate:d}=Xe(),{mutate:C}=Je(),{mutate:y}=Ke(),h=sessionStorage.getItem("continuePage"),f=sessionStorage.getItem("profileId"),v=sessionStorage.getItem("contentId"),[x,N]=r.useState(h&&Number(h)<e?Number(h):1),[g]=Me(Fe),P=$e(),_=!!new URLSearchParams(location.search.split("?")[1]).get("from");r.useEffect(()=>{o(x)},[x]);const R=S=>{x<e&&S==="next"&&N(D=>D+=1),x>1&&S==="prev"&&N(D=>D-=1),i(x)};function M(S){return S<10?"0"+S:S}const L=new Date,k=L.getHours(),u=L.getMinutes(),W=L.getSeconds(),T=M(k)+":"+M(u)+":"+M(W),a=()=>{Ze(`${(g==null?void 0:g.role)=="teacher"?"teacher":(g==null?void 0:g.role)=="user"?"parent":"school"}_lesson_completed`,{user_id:g==null?void 0:g.user_id,profile_id:sessionStorage.getItem("profileId")||0,lession_id:sessionStorage.getItem("coontentId"),lession_category:"stories",media_type:"text",end_time:T}),_?y({profile_id:Number(f),summer_challenge_quiz_id:Number(sessionStorage.getItem("summerQuizId")),content_id:Number(v),status:"complete",pages_read:Number(e+1)},{onSuccess(S){return P("/summer-quiz/preview-summer-challenge"),sessionStorage.removeItem("fromSummer"),S},onError(S){Y.show({title:"Notification",message:re(S)})}}):(g==null?void 0:g.role)==="user"?d({profile_id:Number(f),content_id:Number(v),status:"complete",pages_read:Number(e+1),timespent:23},{onSuccess(S){return sessionStorage.getItem("fromSummer")==="true"?(P("/summer-quiz/preview-summer-challenge"),sessionStorage.removeItem("fromSummer")):s(),S},onError(S){Y.show({title:"Notification",message:re(S)})}}):C({content_id:Number(v),status:"complete",pages_read:Number(e+1),timespent:23},{onSuccess(S){return sessionStorage.getItem("fromSummer")==="true"?(P("/summer-quiz/preview-summer-challenge"),sessionStorage.removeItem("fromSummer")):s(),S},onError(S){Y.show({title:"Notification",message:re(S)})}})},I=[];for(let S=1;S<=e;S++)I.push(t.jsx("option",{id:"pages",value:S,children:S},S));const O=S=>{N(Number(S.target.value))};return t.jsx("div",{children:t.jsxs("div",{className:"flex  justify-between   items-center",children:[t.jsx("span",{className:"flex gap-2",children:t.jsxs("p",{children:["Pages:",t.jsx("select",{name:"",id:"pages",onChange:O,value:x,children:I})]})}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("p",{className:"bg-[#8530C1] text-white  py-3 rounded-3xl px-8 gap-8 flex justify-between  items-center",children:[t.jsx("button",{onClick:()=>{R("prev"),l.current&&(l.current.scrollTop=0)},children:t.jsx(It,{size:40,color:"white",className:"u-react-icon"})}),t.jsxs("span",{className:" space-x-1 text-[20px] font-Hanken",children:[x!==e&&t.jsx("span",{children:x}),x!==e&&t.jsx("span",{children:"/"}),x!==e&&t.jsx("span",{children:e})]}),x!==e&&t.jsx("button",{onClick:()=>{R("next"),l.current&&(l.current.scrollTop=0)},children:t.jsx(_t,{size:40,color:"white",className:"u-react-icon"})})]}),x===e&&t.jsx("button",{onClick:a,className:"p-4 bg-green-600 rounded-3xl text-white px-8",children:"Finish"})]})]})})},Jt=({content:s})=>{const o=$e(),[e]=Me(Fe);function i(v){return v<10?"0"+v:v}const l=new Date,d=l.getHours(),C=l.getMinutes(),y=l.getSeconds(),h=i(d)+":"+i(C)+":"+i(y),f=()=>{Ze(`${(e==null?void 0:e.role)=="teacher"?"teacher":(e==null?void 0:e.role)=="user"?"parent":"school"}_quiz_started`,{user_id:e==null?void 0:e.user_id,profile_d:sessionStorage.getItem("profileId"),lesson_id:sessionStorage.getItem("contentId"),lesson_category:s==null?void 0:s.category,media_type:s==null?void 0:s.media_type,start_time:h}),sessionStorage.setItem("content",JSON.stringify(s)),s.has_quiz===!0?o("quiz"):Y.show({title:"Notification",message:"Quiz is not available for this content"})};return t.jsx("div",{className:" min-h-[calc(92vh-72px-8vh-34px)] h-[100%] flex-grow mt-4 flex justify-center bg-white rounded-3xl items-center",children:t.jsxs("div",{children:[t.jsx("p",{className:"flex justify-center items-center",children:t.jsx(Rt,{className:"",size:150,color:"#8530C1"})}),t.jsxs("div",{className:"text-center",children:[t.jsx("h1",{className:"text-[40px] font-Recoleta font-semibold",children:"Well Done!"}),t.jsxs("p",{className:"text-[#7E7E89] text-[18px]",children:["You have just finished reading ",s==null?void 0:s.name]})]}),t.jsxs("p",{className:"flex flex-col gap-y-3 mt-8",children:[t.jsx("button",{onClick:f,className:"px-16 py-3 bg-[#8530C1] text-white rounded-2xl",children:"Take quiz"}),t.jsx("button",{onClick:()=>{o(-1)},className:"text-[18px] mt-2",children:"Later"})]})]})})};export{as as default};
