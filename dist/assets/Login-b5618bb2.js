import{cX as W,a as A,a5 as q,g as D,cY as O,r as H,cZ as K,f as X,D as N,E as J,H as V,j as a,K as Y,I,a6 as Z,a1 as $,a2 as Q,ad as z,B as f,L as ee,al as ae,am as se,an as oe,J as d,X as n,x,av as _,M as p,ao as te,ap as ie,P as ne}from"./index-7fa67d35.js";import{F as le}from"./index.esm-8a91186a.js";const re=()=>{var k,L;const{isLoading:E,mutate:j}=W(),[b,,]=A(q),[,h]=A(D),{mutate:w,isLoading:U}=O();H.useEffect(()=>{K(),sessionStorage.clear(),sessionStorage.clear()},[]);function F(l){return l.length===1?l[0]:l.find(e=>e.providerId==="google.com")}const R=async()=>{var l,r,e,c,u;try{const t=await oe(),s=F((l=t.user)==null?void 0:l.providerData),m=((r=s==null?void 0:s.displayName)==null?void 0:r.split(" "))??"";w({provider:"google",id:(u=(c=(e=t.user)==null?void 0:e.providerData)==null?void 0:c[0])==null?void 0:u.uid,name:t.user.displayName,email:t.user.email,phoneNumber:t.user.phoneNumber,photoURL:t.user.photoURL,fcmToken:b,first_name:m[0],last_name:m[1]},{onSuccess(o){var S;const i=(S=o==null?void 0:o.data)==null?void 0:S.data;d.show({color:"lime",title:"Notification",message:o.data.message}),n.add_unique_user_id(i==null?void 0:i.user_id),n.add_first_name(i==null?void 0:i.firstname),n.add_last_name(i==null?void 0:i.lastname),n.add_email(i==null?void 0:i.email),n.add_mobile(i==null?void 0:i.phoneNumber),x("web_parent_login",{user_id:i==null?void 0:i.user_id,login_platform:"web",subscription_status:i==null?void 0:i.status,login_date:_,login_method:"Google"}),h({...i}),g("/selectprofile")},onError(o){d.show({color:"lime",title:"Notification",message:p(o)})}})}catch(t){d.show({color:"lime",title:"Notification",message:p(t)})}};function C(l){return l.length===1?l[0]:l.find(e=>e.providerId==="apple.com")}const M=async()=>{var l,r;try{const e=await te(),c=C((l=e.user)==null?void 0:l.providerData),u=((r=c==null?void 0:c.displayName)==null?void 0:r.split(" "))??"";j({provider:"apple",id:c==null?void 0:c.uid,name:e.user.displayName,email:e.user.email,phoneNumber:e.user.phoneNumber,photoURL:e.user.photoURL,fcmToken:b,first_name:u[0],last_name:u[1]},{onSuccess(t){var m;const s=(m=t==null?void 0:t.data)==null?void 0:m.data;n.add_unique_user_id(s==null?void 0:s.user_id),n.add_first_name(s==null?void 0:s.firstname),n.add_last_name(s==null?void 0:s.lastname),n.add_email(s==null?void 0:s.email),n.add_mobile(s==null?void 0:s.phoneNumber),x("web_parent_login",{user_id:s==null?void 0:s.user_id,login_platform:"web",subscription_status:s==null?void 0:s.status,login_date:_,login_method:"apple"}),h({...s}),g("/packages")},onError(t){d.show({title:"Notification",message:p(t)})}})}catch(e){d.show({title:"Notification",message:p(e)})}},P=async()=>{var l,r,e,c,u;try{const t=await ie(),s=((r=(l=t==null?void 0:t.user)==null?void 0:l.displayName)==null?void 0:r.split(" "))??"";w({provider:"facebook",id:(u=(c=(e=t.user)==null?void 0:e.providerData)==null?void 0:c[0])==null?void 0:u.uid,name:t.user.displayName,email:t.user.email,phoneNumber:t.user.phoneNumber,photoURL:t.user.photoURL,fcmToken:b,first_name:s[0],last_name:s[1]},{onSuccess(m){var i;const o=(i=m==null?void 0:m.data)==null?void 0:i.data;n.add_unique_user_id(o==null?void 0:o.user_id),n.add_first_name(o==null?void 0:o.firstname),n.add_last_name(o==null?void 0:o.lastname),n.add_email(o==null?void 0:o.email),n.add_mobile(o==null?void 0:o.phoneNumber),x("web_parent_login",{user_id:o==null?void 0:o.user_id,login_platform:"web",subscription_status:o==null?void 0:o.status,login_date:_,login_method:"FB"}),h({...o}),g("/selectprofile")},onError(m){d.show({title:"Notification",message:p(m)})}})}catch(t){d.show({title:"Notification",message:p(t)})}},g=X(),B=N.object({email:N.string().email(),password:N.string().min(4,{message:"Password must be at least 4 characters long"}).max(20,{message:"Password must not exceed 20 characters"})}),{register:y,handleSubmit:G,formState:{errors:v}}=J({resolver:V(B)}),T=async l=>{j({...l},{async onSuccess(r){var c;sessionStorage.clear();const e=(c=r==null?void 0:r.data)==null?void 0:c.data;n.add_unique_user_id(e==null?void 0:e.user_id),n.add_first_name(e==null?void 0:e.firstname),n.add_last_name(e==null?void 0:e.lastname),n.add_email(e==null?void 0:e.email),n.add_mobile(e==null?void 0:e.phoneNumber),x(`web_${(e==null?void 0:e.role)=="teacher"?"teacher":(e==null?void 0:e.role)=="user"?"parent":"school"}
_login`,{user_id:e==null?void 0:e.user_id,login_platform:"web",subscription_status:e==null?void 0:e.status,login_date:_,login_method:"manual"}),h({...e}),d.show({title:"Notification",message:r.data.message}),(e==null?void 0:e.role)==="schoolAdmin"||(e==null?void 0:e.role)==="teacher"?g("/schooldashboard"):((e==null?void 0:e.role)==="parent"||(e==null?void 0:e.role)==="user")&&g("/selectprofile")},onError(){d.show({color:"lime",title:"Notification",message:"Invalid username or password"})}})};return a.jsx("div",{className:"flex justify-center  max-h-[90vh] overflow-auto py-[30px] bg-white rounded-[50px] min-w-[550px] ",children:a.jsxs("div",{className:"inner-form-w relative",children:[a.jsx("div",{className:"flex justify-center items-center mt-0 mb-12 ",children:a.jsx("img",{src:Y,alt:"image",className:"w-[160px]"})}),a.jsxs("div",{className:"w-[100%] ",children:[a.jsx("span",{}),a.jsx("h1",{className:"font-bold fon header2 font-BalooSemiBold text-center   ",children:"Welcome back"}),a.jsx("p",{className:"text3 text-[#A7A7A7] font-ArimoRegular text-center ",children:"Welcome back! please enter your details"}),a.jsxs("form",{onSubmit:G(T),className:"text3 mt-10",children:[a.jsx("p",{className:"my-4",children:a.jsx(I,{type:"text",placeholder:"Email",reg:y("email"),leftIcon:a.jsx(Z,{size:20,className:" mx-auto",color:"#c4ccd0"}),errorMsg:(k=v.email)==null?void 0:k.message})}),a.jsx("p",{className:"my-2",children:a.jsx(I,{type:"password",placeholder:"Password",reg:y("password"),leftIcon:a.jsx($,{size:20,color:"#c4ccd0"}),rightIcon:a.jsx(Q,{size:22,color:"#c4ccd0"}),errorMsg:(L=v.password)==null?void 0:L.message})}),a.jsx("p",{className:"flex justify-end text3 mb-4 text-customGreen font-bold",children:a.jsx(z,{to:"/forgotpassword",children:a.jsx("button",{children:"Forgot password?"})})}),a.jsx(f,{type:"submit",size:"full",backgroundColor:"green",className:"rounded-full",children:E?a.jsx("p",{className:"flex justify-center items-center",children:a.jsx(ee,{color:"white",size:"sm"})}):a.jsx("span",{children:"Login"})})]}),a.jsxs("p",{className:"flex items-center text3 justify-items-center py-5 gap-3  text-gray-400 font-400",children:[a.jsx("hr",{className:"flex-1"}),a.jsx("span",{children:"or continue with"})," ",a.jsx("hr",{className:"flex-1"})]}),a.jsxs("div",{className:"flex gap-8",children:[a.jsx(f,{disable:U,size:"full",onClick:R,varient:"outlined",borderColor:"green",children:a.jsx(le,{size:20,className:" mx-auto"})}),a.jsx(f,{onClick:M,size:"full",varient:"outlined",borderColor:"green",children:a.jsx(ae,{size:20,className:" mx-auto",color:"black"})}),a.jsx(f,{onClick:P,size:"full",varient:"outlined",borderColor:"green",children:a.jsx(se,{size:20,className:" mx-auto",color:"black"})})]}),a.jsxs("p",{className:"mt-2 text-center text-[] text-gray-400 ",children:[a.jsx("span",{className:"font-Hanken",children:"Don't hava an account? "}),a.jsx(z,{to:"/signup",children:a.jsx("button",{className:"mt-4 text-customGreen font-bold",children:"Sign up"})})]})]})]})})},de=()=>a.jsx("div",{className:"flex",children:a.jsx(ne,{children:a.jsx(re,{})})});export{de as default};
