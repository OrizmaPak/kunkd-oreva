import{f as ee,a as H,g as R,j as e,$ as k,cM as le,ct as ie,cu as oe,r as l,a0 as K,bh as de,bi as me,T as Q,l as ue,k as xe,bg as fe,cv as he,cw as ge,m as O,bl as G,cx as pe,cy as je,cz as Ne,R as Ce,cA as Se,cB as ve,cs as we,J as S,M as I,cr as Y,cN as ye,cq as be,cp as Te,cO as Ie,cP as _e,X as Me}from"./index-7fa67d35.js";import{N as Z}from"./nexticon-3dad45ac.js";import{T as Ae,C as Be,a as Ee}from"./TabInReadingPage-f60bc204.js";import{S as q}from"./Slider-1f935c81.js";import"./videoicon-372ef70a.js";const Pe=({category:n,title:p,quiz:s})=>{const i=ee(),[o]=H(R);return e.jsxs("div",{className:"py-4 pl-20 font-Recoleta content-nav text25  font-semibold items-center rounded-full bg-white gap-8 flex pad-x-40",children:[e.jsxs("div",{className:"flex gap-2 cursor-pointer ",onClick:()=>{i(`/${(o==null?void 0:o.role)==="user"?"parent":"school"}/audiobooks`)},children:[e.jsx("span",{children:n}),e.jsx("img",{loading:"lazy",src:Z,alt:"nextIcon"})]}),e.jsxs("div",{className:`flex gap-2  cursor-pointer text-[#B5B5C3] ${s&&"text-black"} `,children:[e.jsx("span",{children:p}),s&&e.jsx("img",{loading:"lazy",src:Z,alt:"nextIcon"})]}),e.jsx("div",{className:" cursor-pointer ",children:e.jsx("span",{children:s})})]})},Re=()=>{var A,y,C;const[n,{open:p,close:s}]=k(!1),[i,{open:o,close:a}]=k(!1),m=ee(),d=sessionStorage.getItem("contentId"),{data:v}=le(d),c=(y=(A=v==null?void 0:v.data)==null?void 0:A.data)==null?void 0:y.recommended_contents,w=sessionStorage.getItem("profileId"),[j]=H(R),N=(j==null?void 0:j.role)==="user",b=d==null?void 0:d.toString(),u=(w==null?void 0:w.toString())||"0",B=ie(N,b,u,p,o),_=oe(N,b,p),{data:x,isLoading:M}=N?B:_;console.log("matthew",x);const L=x==null?void 0:x.data.data.id,f=(C=x==null?void 0:x.data.data.media)==null?void 0:C[0],[E,P]=l.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(K,{radius:10,padding:30,size:"md",opened:n,onClose:s,overlayProps:{blur:10},closeOnClickOutside:!1,withCloseButton:!1,centered:!0,children:e.jsx(Ae,{onCancel:s})}),e.jsx(K,{radius:10,padding:30,size:"md",opened:i,onClose:a,overlayProps:{blur:10},closeOnClickOutside:!1,withCloseButton:!1,centered:!0,children:e.jsx(Be,{onCancel:a})}),e.jsx(de,{bgColor:"#fff7fd",children:e.jsx(me,{children:e.jsx("div",{className:" ",children:e.jsxs("div",{className:" min-h-[calc(92vh-60px)] h-[100%] flex flex-col bg-[#fff7fd]  ",children:[e.jsx("div",{className:" ",children:e.jsx(Q,{visible:M,radius:"xl",children:e.jsx(Pe,{category:"Audiobooks",title:f&&(f==null?void 0:f.name)})})}),e.jsx("div",{className:"flex-grow  h-full ",children:e.jsx("div",{className:"flex-grow  mt-5 rounded-2xl",children:e.jsxs("div",{className:"flex h-full  gap-4  flex-grow-1 flex-col ",children:[e.jsx(Q,{visible:M,children:!E&&e.jsx(De,{audiobook:f,setStartRead:()=>P(!0),audioBookId:L})}),f&&E&&e.jsx(Le,{audiobook:f}),e.jsx(Ee,{}),e.jsx("div",{className:"w-full bg-white rounded-3xl mt-4",children:e.jsx(ue,{data:c,header:"New & Trending",actiontitle:"",isTitled:!1,isLoading:M,card:h=>e.jsx(xe,{...h,goTo:()=>{var D;return m(`../audiobooks/${h==null?void 0:h.theme}/${(D=h==null?void 0:h.slug)==null?void 0:D.replace(/\s/g,"_").toLowerCase()}`)}})})})]})})})]})})})})]})},De=({audiobook:n,setStartRead:p,audioBookId:s})=>{const i=sessionStorage.getItem("profileId"),{data:o,refetch:a}=fe(i),m=o==null?void 0:o.data.data.records,{mutate:d}=he(),{mutate:v}=ge(),c=m==null?void 0:m.filter(u=>u.id===s),w=()=>{b(),(c==null?void 0:c.length)===0||c===void 0?d({content_id:s,profile_id:Number(i)},{onSuccess(){a(),S.show({title:"Notification",message:(n==null?void 0:n.name)+" added to list"})},onError(u){S.show({title:"Notification",message:I(u)})}}):v({content_id:s,profile_id:Number(i)},{onSuccess(){a(),S.show({title:"Notification",message:(n==null?void 0:n.name)+" removed from the list"})},onError(u){S.show({title:"Notification",message:I(u)})}})},[j,N]=l.useState(!1),b=()=>{N(!0),setTimeout(()=>{N(!1)},200)};return e.jsxs("div",{className:"bg-[#003914]   w-[100%] flex rounded-3xl pad-x-40 about-card-px py-5",children:[e.jsxs("div",{className:"flex basis-full  border-r-2 justify-center items-center border-[#008A3B]  ",children:[e.jsx("p",{className:"flex flex-col w-full",children:n?e.jsx(O.LazyLoadImage,{src:n==null?void 0:n.thumbnail,placeholderSrc:G,effect:"blur",className:"rounded-2xl about-img ",wrapperClassName:"about-img"}):e.jsx(O.LazyLoadImage,{placeholderSrc:G,effect:"blur",className:"rounded-2xl about-img ",wrapperClassName:"about-img"})}),e.jsxs("p",{className:"grid flex-col w-full   h-full py-2 ",children:[e.jsx("span",{className:"font-bold font-Recoleta text-white text25 justify-self-start",children:n==null?void 0:n.name}),e.jsx("span",{className:" text-[#008A3B]",children:"Dele and Louisa Olafuyi"}),e.jsxs("p",{className:"flex   gap-2 ",children:[e.jsx("button",{onClick:p,className:" py-3 px-10 inline self-end text-white border-white border-[2px] rounded-2xl",children:"Play"}),e.jsxs("button",{onClick:w,className:`px-4 py-2 rounded-md transition-all inline self-end items-center     ${j?"scale-150":""}`,children:[(c==null?void 0:c.length)>0?e.jsx(pe,{size:"35",color:"white",className:" scale-110"}):e.jsx(je,{size:"35",color:"white"}),e.jsx("style",{children:`
            @keyframes shake {
  0%, 100% {
    transform: translateX(0);
  }
  10%, 30%, 50%, 70%, 90% {
    transform: translateX(-10px);
  }
  20%, 40%, 60%, 80% {
    transform: translateX(10px);
  }
}

.animate-shake {
  animation: shake 0.3s infinite;
}`})]})]})]})]}),e.jsx("div",{className:" basis-3/4 text-[#008A3B] pad-x-40",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-white font-bold  font-Hanken text25 my-2",children:"Overview"}),e.jsx("p",{dangerouslySetInnerHTML:{__html:`${n==null?void 0:n.slug}`}})]})})]})},Le=({audiobook:n})=>e.jsx("div",{className:"flex bg-[#fff7fd]  gap-16 rounded-3xl ",children:e.jsxs("div",{className:" basis-full flex   bg-[white]  p-10 rounded-3xl gap-24 ",children:[e.jsx("div",{children:e.jsx(O.LazyLoadImage,{src:n.thumbnail,placeholderSrc:G,effect:"blur",className:" rounded-xl",wrapperClassName:"",width:229,height:229})}),e.jsx("div",{className:" flex-grow",children:e.jsx(Fe,{audio:n&&n.file,title:n==null?void 0:n.name})})]})}),Fe=({audio:n,title:p})=>{var U,V,W,J;const s=l.useRef(null),[i,o]=l.useState(!1),[a,m]=l.useState(0),[d,v]=l.useState(0),[c,w]=l.useState(!1),[j,N]=l.useState(0);l.useEffect(()=>{const t=sessionStorage.getItem("continuePage");t&&s.current&&(s.current.currentTime=Number(t))},[]);const b=()=>{var r;const t=s.current;if(o(!i),t&&!t.paused)return t.pause();(r=s==null?void 0:s.current)==null||r.play()},u=t=>()=>{const r=s.current,$=(r==null?void 0:r.duration)||0,T=(r==null?void 0:r.currentTime)||0;r!=null&&r.currentTime&&(r!=null&&r.currentTime&&c&&t==="forward"&&(r==null?void 0:r.currentTime)<$?r.currentTime+=10:r.currentTime&&c&&t==="backward"&&(r.currentTime-=T-10<0?T:10))},B=20;l.useEffect(()=>{let t;s.current&&(t=Math.floor(s==null?void 0:s.current.duration),v(+t))},[(U=s==null?void 0:s.current)==null?void 0:U.onloadedmetadata,(V=s==null?void 0:s.current)==null?void 0:V.readyState,(W=s==null?void 0:s.current)==null?void 0:W.onload,(J=s==null?void 0:s.current)==null?void 0:J.oncanplaythrough]);const _=t=>{if(s.current){const r=Math.floor(t/60),$=r<10?`0${r}`:`${r}`,T=Math.floor(t%60),ce=T<10?`0${T}`:`${T}`;return`${$}: ${ce}`}},x=Ne(),M=t=>(m(t),c&&s.current&&(s.current.currentTime=t),t),[L,f]=Ce.useState(50),E=t=>{f(t);const r=Number(t)/B;s.current&&(s.current.volume=r)},{mutate:P}=Se(),{mutate:A}=ve(),y=sessionStorage.getItem("profileId"),C=sessionStorage.getItem("contentId"),{mutate:h}=we(),[D,X]=l.useState(0),[g]=H(R);function F(t){return t<10?"0"+t:t}const z=new Date,te=z.getHours(),se=z.getMinutes(),ne=z.getSeconds(),re=F(te)+":"+F(se)+":"+F(ne);l.useEffect(()=>{let t;return i&&(t=setInterval(()=>{N(r=>r+1)},5e3)),()=>{clearInterval(t)}},[i]),l.useEffect(()=>{j>0&&((g==null?void 0:g.role)==="user"?P({profile_id:Number(y),content_id:Number(C),status:a===d?"complete":"ongoing",pages_read:Math.ceil(a),timespent:Math.ceil(a)},{onSuccess(t){return X(Math.ceil(a)),t},onError(t){S.show({title:"Notification",message:I(t)})}}):A({content_id:Number(C),status:a===d?"complete":"ongoing",pages_read:Math.ceil(a),timespent:Math.ceil(a)},{onSuccess(t){return X(Math.ceil(a)),t},onError(t){S.show({title:"Notification",message:I(t)})}}),h({content_id:Number(C),profile_id:Number(y),timespent:Math.ceil(a)-D}))},[j]);const ae=async()=>{Me.track_event("web_lesson_completed",{user_id:g==null?void 0:g.user_id,profile_id:sessionStorage.getItem("profileId")||0,lession_id:sessionStorage.getItem("coontentId"),lession_category:"Audiobooks",media_type:"audio",end_time:re}),(g==null?void 0:g.role)==="user"?P({profile_id:Number(y),content_id:Number(C),status:"complete",pages_read:Math.ceil(a),timespent:Math.ceil(a)},{onSuccess(t){return t},onError(t){S.show({title:"Notification",message:I(t)})}}):A({profile_id:Number(y),content_id:Number(C),status:"complete",pages_read:Math.ceil(a),timespent:Math.ceil(a)},{onSuccess(t){return t},onError(t){S.show({title:"Notification",message:I(t)})}})};return e.jsxs("div",{className:"h-[229px]",children:[e.jsx("h1",{className:"text-[22px] font-semibold text-[#151515]",children:p}),e.jsx("div",{className:"my-3 flex justify-center items-center gap-2 mt-8",children:e.jsx("p",{className:"w-full flex-grow",children:e.jsx(Y,{theme:{colors:{"ocean-blue":["#8530c1","#5FCCDB","#44CADC","#2AC9DE","#1AC2D9","#11B7CD","#09ADC3","#0E99AC","#128797","#147885"]}},children:e.jsx(q,{color:"ocean-blue.0",value:a,onChange:t=>{M(t)},min:0,max:d,step:.1,label:`Duration: ${_(a)}`,disabled:x})})})}),e.jsxs("div",{className:"flex  justify-between ",children:[e.jsx("p",{children:a&&_(a)}),e.jsx("p",{children:d?_(d):"0:00"})]}),e.jsxs("div",{className:"flex justify-between mt-8",children:[e.jsxs("div",{className:"flex justify-center h-[72px]",children:[e.jsx("audio",{id:"audio-book",onTimeUpdate:t=>{m(+t.currentTarget.currentTime)},onEnded:()=>{o(!1),ae()},onCanPlayThrough:t=>{m(+t.currentTarget.currentTime)},ref:s,src:n&&n,onCanPlay:t=>{m(+t.currentTarget.currentTime),w(!0)}}),e.jsxs("div",{className:"flex h-[72px] justify-end rounded-full gap-10 px-10 py-4 bg-[#FBECFF] items-center ",children:[e.jsx("button",{onClick:u("backward"),children:e.jsx(ye,{size:25,color:"red",className:"u-react-icon"})}),e.jsx("button",{onClick:b,children:i?e.jsx(be,{size:40,color:"#8530C1"}):e.jsx(Te,{size:40,color:"#8530C1"})}),e.jsx("button",{onClick:u("forward"),children:e.jsx(Ie,{size:25,color:"red",className:"u-react-icon"})})]})]}),e.jsxs("div",{className:" flex justify-center items-center gap-2",children:[e.jsx(_e,{size:25}),e.jsx("p",{className:"w-[100px]",children:e.jsx(Y,{theme:{colors:{"ocean-blue":["#8530c1","#5FCCDB","#44CADC","#2AC9DE","#1AC2D9","#11B7CD","#09ADC3","#0E99AC","#128797","#147885"]}},children:e.jsx(q,{color:"ocean-blue.0",value:L,onChange:E,min:0,max:B,disabled:x,size:"sm"})})})]})]})]})};export{Re as default};
