import{cI as oe,R as S,cR as ae,n as le,r as D,q as ie,s as de,cS as ce,Y as A,j as t,bh as xe,bi as me,T as L,cr as pe,aU as he,bm as Q,bn as Y,bL as j,B as fe,cT as ge,cU as _e,a as X,g as Z,L as ve,f as ue,cV as b,cW as ye,x as H,J as E,M as V}from"./index-7fa67d35.js";import{S as we}from"./StoriesNav-d72f1143.js";import"./nexticon-3dad45ac.js";function Ne({size:e,thickness:s,sum:r,value:n,root:i,offset:x}){const m=(e*.9-s*2)/2,a=Math.PI*m*2/100,o=i?`${(100-r)*a}, ${r*a}`:`${n*a}, ${(100-n)*a}`;return{strokeWidth:s,cx:e/2,cy:e/2,r:m,transform:i?`scale(1, -1) translate(0, -${e})`:null,strokeDasharray:o,strokeDashoffset:i?0:x}}var Se=Object.defineProperty,Ce=Object.defineProperties,Pe=Object.getOwnPropertyDescriptors,B=Object.getOwnPropertySymbols,O=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable,W=(e,s,r)=>s in e?Se(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r,G=(e,s)=>{for(var r in s||(s={}))O.call(s,r)&&W(e,r,s[r]);if(B)for(var r of B(s))q.call(s,r)&&W(e,r,s[r]);return e},$e=(e,s)=>Ce(e,Pe(s)),Ie=(e,s)=>{var r={};for(var n in e)O.call(e,n)&&s.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&B)for(var n of B(e))s.indexOf(n)<0&&q.call(e,n)&&(r[n]=e[n]);return r};function ee(e){var s=e,{size:r,value:n,offset:i,sum:x,thickness:m,root:a,color:o,lineRoundCaps:c,tooltip:l}=s,f=Ie(s,["size","value","offset","sum","thickness","root","color","lineRoundCaps","tooltip"]);const h=oe(),g=h.fn.themeColor(o||(h.colorScheme==="dark"?"dark":"gray"),o?h.fn.primaryShade():h.colorScheme==="dark"?4:1,!1);return S.createElement(ae.Floating,{disabled:!l,label:l},S.createElement("circle",G($e(G({},f),{fill:"none",strokeLinecap:c?"round":"butt",stroke:g}),Ne({sum:x,size:r,thickness:m,value:n,offset:i,root:a}))))}ee.displayName="@mantine/core/Curve";var Re=Object.defineProperty,ke=Object.defineProperties,Ee=Object.getOwnPropertyDescriptors,J=Object.getOwnPropertySymbols,ze=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable,U=(e,s,r)=>s in e?Re(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r,C=(e,s)=>{for(var r in s||(s={}))ze.call(s,r)&&U(e,r,s[r]);if(J)for(var r of J(s))De.call(s,r)&&U(e,r,s[r]);return e},P=(e,s)=>ke(e,Ee(s));function Be({size:e,thickness:s,sections:r,renderRoundedLineCaps:n,rootColor:i}){const x=r.reduce((l,f)=>l+f.value,0),m=Math.PI*((e*.9-s*2)/2)*2;let a=m;const o=[],c=[];for(let l=0;l<r.length;l+=1)o.push({sum:x,offset:a,data:r[l],root:!1}),a-=r[l].value/100*m;if(o.push({sum:x,offset:a,data:{color:i},root:!0}),c.push(P(C({},o[o.length-1]),{lineRoundCaps:!1})),o.length>2){c.push(P(C({},o[0]),{lineRoundCaps:n})),c.push(P(C({},o[o.length-2]),{lineRoundCaps:n}));for(let l=1;l<=o.length-3;l+=1)c.push(P(C({},o[l]),{lineRoundCaps:!1}))}else c.push(P(C({},o[0]),{lineRoundCaps:n}));return c}var Te=le({root:{position:"relative"},label:{position:"absolute",top:"50%",transform:"translateY(-50%)"}});const Me=Te;var Fe=Object.defineProperty,Ae=Object.defineProperties,Le=Object.getOwnPropertyDescriptors,T=Object.getOwnPropertySymbols,te=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable,K=(e,s,r)=>s in e?Fe(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r,M=(e,s)=>{for(var r in s||(s={}))te.call(s,r)&&K(e,r,s[r]);if(T)for(var r of T(s))se.call(s,r)&&K(e,r,s[r]);return e},Qe=(e,s)=>Ae(e,Le(s)),Ye=(e,s)=>{var r={};for(var n in e)te.call(e,n)&&s.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&T)for(var n of T(e))s.indexOf(n)<0&&se.call(e,n)&&(r[n]=e[n]);return r};const je={size:120,thickness:12},re=D.forwardRef((e,s)=>{const r=ie("RingProgress",je,e),{className:n,style:i,label:x,sections:m,size:a,thickness:o,classNames:c,styles:l,roundCaps:f,rootColor:h,unstyled:g,variant:y}=r,_=Ye(r,["className","style","label","sections","size","thickness","classNames","styles","roundCaps","rootColor","unstyled","variant"]),{classes:p,cx:d}=Me(null,{name:"RingProgress",classNames:c,styles:l,unstyled:g,variant:y}),w=Be({size:a,thickness:o,sections:m,renderRoundedLineCaps:f,rootColor:h}).map(({data:N,sum:$,root:u,lineRoundCaps:v,offset:I},R)=>S.createElement(ee,Qe(M({},N),{key:R,size:a,thickness:o,sum:$,offset:I,color:N==null?void 0:N.color,root:u,lineRoundCaps:v})));return S.createElement(de,M({style:M({width:a,height:a},i),className:d(p.root,n),ref:s},_),S.createElement("svg",{style:{width:a,height:a,transform:"rotate(-90deg)"}},w),x&&S.createElement("div",{className:p.label,style:{right:o*2,left:o*2}},x))});re.displayName="@mantine/core/RingProgress";const He="/assets/remarkbg-db3d5ad7.svg",Ve="/assets/remarkIcon-6b338a05.svg",We="/assets/contour-1c69c70b.svg",Ge="/assets/SmileyMeh-d-cbc86863.svg",st=()=>{var d,w,N,$;const e=sessionStorage.getItem("contentId"),{data:s,isLoading:r}=ce(e==null?void 0:e.toString()),n=(w=(d=s==null?void 0:s.data)==null?void 0:d.data)==null?void 0:w.questions,i=($=(N=s==null?void 0:s.data)==null?void 0:N.data)==null?void 0:$.quiz_id,x=sessionStorage.getItem("profileId"),m=sessionStorage.getItem("content"),a=JSON.parse(m),[o,c]=D.useState(0),[l,f]=D.useState([]),h=u=>{u==="next"&&o<n.length-1&&c(v=>v+=1),u==="prev"&&o>=1&&c(v=>v-=1)},g=({question:u,actual_answer:v,question_id:I,selected_option:R,selected_option_value:F})=>{f(ne=>{const k=[...ne];return k[o]?k[o]={question_id:I,question:u,actual_answer:v,selected_option:R,selected_option_value:F}:k.push({question_id:I,question:u,actual_answer:v,selected_option:R,selected_option_value:F}),k})},y=100/(n==null?void 0:n.length),[_,p]=D.useState(A);return t.jsx(t.Fragment,{children:t.jsx(xe,{bgColor:"#fff7fd",children:t.jsx(me,{children:t.jsxs("div",{className:" min-h-[calc(92vh-60px)] h-[100%] flex flex-col bg-[#fff7fd] w-[100%] ",children:[t.jsx(L,{visible:r,children:t.jsx(we,{category:a==null?void 0:a.category,genre:a&&a.sub_categories[0].sub_category_name,title:a&&a.name,subCategoryId:a&&a.sub_categories[0].sub_category_id,slug:a&&a.sub_categories[0].sub_category_name,quiz:"Quiz"})}),_===A&&t.jsx(t.Fragment,{children:t.jsx(L,{visible:r,height:600,children:t.jsxs("div",{className:"flex-grow mt-5 pt-5 px-40 flex  h-[100%]  flex-col py-5 bg-white rounded-3xl ",children:[t.jsx(pe,{theme:{colors:{"ocean-blue":["#8530C1","#5FCCDB","#44CADC","#2AC9DE","#1AC2D9","#11B7CD","#09ADC3","#0E99AC","#128797","#147885"]}},children:t.jsx(he,{value:y*l.length,size:"xl",radius:"xl",color:"ocean-blue.0"})}),t.jsx(Je,{quesObject:n&&n[o],selected:l,setSelected:g,currentQuestion:o}),t.jsx(Ue,{handlePagination:h,totalQuestion:n&&(n==null?void 0:n.length),currentQues:n&&o,answers:l&&l,questions:n??[],handleSelectAnswer:g,setShowResult:()=>p(Q)})]})})}),_===Q&&t.jsx("div",{className:"flex-grow mt-5 pt-10 flex  justify-center items-center  mx-auto w-[100%]  flex-col py-14 bg-white m rounded-3xl ",children:t.jsx(Xe,{profileId:+x,quizId:+i,answers:l,setShowRemark:()=>p(Y)})}),_===Y&&t.jsx("div",{className:"flex-grow mt-5 pt-10 px-40 flex  flex-col py-14 bg-white rounded-3xl ",children:t.jsx(Ke,{answers:l,setShowYourResult:()=>p(j)})}),_===j&&t.jsx("div",{className:"flex-grow mt-5 pt-10  mx-auto  flex justify-center items-center  flex-col py-14 bg-white   w-[100%] rounded-3xl ",children:t.jsx(Ze,{answers:l})})]})})})})},Je=({quesObject:e,selected:s,setSelected:r,currentQuestion:n})=>t.jsxs("div",{className:" flex justify-start mt-14 items-center flex-col gap-y-4 flex-grow ",children:[t.jsx("h1",{className:"text-[24px] font-bold  text-center mb-8",dangerouslySetInnerHTML:{__html:`${e==null?void 0:e.question}`}}),t.jsxs("div",{className:" flex flex-col gap-6",children:[t.jsx(z,{selected_option:"a",question_id:e==null?void 0:e.question_id,title:e==null?void 0:e.option_a,actual_answer:e!=null&&e.answer?e[`option_${e==null?void 0:e.answer}`]:"",question:e==null?void 0:e.question,selected:s[n],setSelected:r}),t.jsx(z,{selected_option:"b",question_id:e==null?void 0:e.question_id,title:e==null?void 0:e.option_b,question:e==null?void 0:e.question,selected:s[n],actual_answer:e!=null&&e.answer?e[`option_${e==null?void 0:e.answer}`]:"",setSelected:r}),t.jsx(z,{selected_option:"c",question_id:e==null?void 0:e.question_id,title:e==null?void 0:e.option_c,question:e==null?void 0:e.question,selected:s[n],actual_answer:e!=null&&e.answer?e[`option_${e==null?void 0:e.answer}`]:"",setSelected:r}),(e==null?void 0:e.option_d)&&(e==null?void 0:e.option_d)!==""&&t.jsx(z,{selected_option:"d",question_id:e==null?void 0:e.question_id,title:e==null?void 0:e.option_d,question:e==null?void 0:e.question,selected:s[n],actual_answer:e!=null&&e.answer?e[`option_${e==null?void 0:e.answer}`]:"",setSelected:r})]})]}),z=({title:e,question:s,selected:r,setSelected:n,actual_answer:i,question_id:x,selected_option:m})=>{const a=()=>{n({selected_option_value:e,question:s,actual_answer:i,question_id:x,selected_option:m})};return t.jsx("button",{onClick:a,className:`py-3 px-10 w-[478px] font-thin ${(r==null?void 0:r.selected_option_value)===e?"bg-[#8530C1] text-white ":"text-[#8530C1]"} border border-[#8530C1] rounded-2xl texx`,dangerouslySetInnerHTML:{__html:e}})},Ue=({handlePagination:e,currentQues:s,totalQuestion:r,answers:n,setShowResult:i,questions:x,handleSelectAnswer:m})=>{const a=x[s],o=a!=null&&a.answer?a[`option_${a==null?void 0:a.answer}`]:"",c=()=>{n[s]||m({question:a==null?void 0:a.question,actual_answer:o}),e("next")};return t.jsxs("div",{children:[t.jsx("hr",{className:"mb-5"}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("button",{onClick:()=>e("prev"),className:"py-3 px-16 bg-[#E2B6FF]   rounded text-white",children:"Prev"}),t.jsxs("span",{children:["Question ",s+1," of ",r]}),n.length===r&&s+1===r?t.jsx("button",{onClick:i,className:"py-3 px-16 bg-green-600 rounded  text-white",children:"Finish Quiz"}):t.jsx("button",{onClick:c,className:"py-3 px-16 bg-[#8530C1] rounded text-white",children:"Next"})]})]})},Ke=({setShowYourResult:e,answers:s})=>{const r=()=>{window.location.reload()},n=s.filter(i=>i.selected_option_value===i.actual_answer);return t.jsxs(t.Fragment,{children:[n.length<s.length/2?t.jsxs("div",{className:"relative flex-grow bg-white ",children:[t.jsx("img",{src:Ge,alt:"remarkIcon",className:"absolute left-1/2 top-[30%] transform -translate-x-1/2 -translate-y-1/2"}),t.jsxs("div",{className:"text-center  mt-[290px]",children:[t.jsx("h1",{className:"font-bold",children:"You can do better!"}),t.jsxs("p",{className:"text-[18px] text-[#B5B5C3]",children:["You answered ",n.length," questions correct"]})]})]}):t.jsxs("div",{className:"relative flex-grow bg-white ",children:[t.jsx("img",{src:He,alt:"",className:"absolute left-1/2 top-[30%]  transform -translate-x-1/2 -translate-y-1/2"}),t.jsx("img",{src:Ve,alt:"remarkIcon",className:"absolute left-1/2 top-[30%] transform -translate-x-1/2 -translate-y-1/2"}),t.jsxs("div",{className:"text-center  mt-[290px]",children:[t.jsx("h1",{className:"font-bold",children:"Good Job!"}),t.jsxs("p",{className:"text-[18px] text-[#B5B5C3]",children:["You answered ",n.length," questions correct"]})]})]}),t.jsx("div",{children:t.jsxs("div",{className:"flex justify-between items-center text-white",children:[t.jsx(fe,{onClick:r,size:"sm",color:"black",varient:"outlined",children:t.jsx("strong",{className:"text-[#8530C1] py-3",children:"Retake Quiz"})}),t.jsx("div",{className:"flex gap-20",children:t.jsx("button",{onClick:e,className:"py-3 px-16 bg-[#8530C1] rounded",children:"Review quiz"})})]})})]})},Xe=({answers:e,profileId:s,quizId:r,setShowRemark:n})=>{const{mutate:i,isLoading:x}=ge(),{mutate:m,isLoading:a}=_e(),[o]=X(Z);function c(d){return d<10?"0"+d:d}const l=new Date,f=l.getHours(),h=l.getMinutes(),g=l.getSeconds(),y=c(f)+":"+c(h)+":"+c(g),_=()=>{(o==null?void 0:o.role)==="user"?i({quiz_id:r,profile_id:s||0,questions:[...e]},{onSuccess(d){H(`${(o==null?void 0:o.role)=="teacher"?"teacher":(o==null?void 0:o.role)=="user"?"parent":"school"}_quiz_completed`,{user_id:o==null?void 0:o.user_id,profile_d:sessionStorage.getItem("profileId"),lesson_id:sessionStorage.getItem("contentId"),lesson_category:"stories",media_type:"text",start_time:y,quiz_score:100/e.length*p.length}),n(),E.show({title:"Notification",message:d.data.message})},onError(d){E.show({title:"Notification",message:V(d)})}}):m({quiz_id:r,questions:[...e]},{onSuccess(d){H(`${(o==null?void 0:o.role)=="teacher"?"teacher":(o==null?void 0:o.role)=="user"?"parent":"school"}_quiz_completed`,{user_id:o==null?void 0:o.user_id,profile_d:sessionStorage.getItem("profileId"),lesson_id:sessionStorage.getItem("contentId"),lesson_category:"stories",media_type:"text",start_time:y,quiz_score:100/e.length*p.length}),n(),E.show({title:"Notification",message:d.data.message})},onError(d){E.show({title:"Notification",message:V(d)})}})},p=e.filter(d=>d.selected_option_value!==void 0);return t.jsxs("div",{className:"relative mx-auto flex-grow bg-white  w-[780px] rounded-3xl",children:[t.jsxs("div",{className:"flex mx-auto relative justify-center items-center gap-10 px-5 bg-[#2BB457] w-[672px] h-[385px] rounded-3xl",children:[t.jsx("img",{src:We,alt:"image",className:"absolute object-cover w-[100%]"}),t.jsx("p",{children:t.jsx(re,{size:300,thickness:30,sections:[{value:100/e.length*p.length,color:"white"}],label:t.jsxs("h1",{className:"font-bold text-white  text-center text-[30px]",children:[t.jsx("span",{className:"text-[40px]",children:p.length}),"/",e.length]}),rootColor:"rgba(255,255,255,0.4)"})}),t.jsxs("p",{className:"text-[24px] font-semibold  text-white ",children:["You answered ",p.length," of ",e.length," questions"]})]}),t.jsx("div",{className:"my-10 text-center",children:t.jsx("h1",{className:"text-[24px] font-bold ",children:"Your Answers"})}),t.jsxs("div",{className:" flex bg-[#FFF7FD] py-10 rounded-3xl   flex-col",children:[e.map((d,w)=>t.jsx(be,{...d,index:w})),t.jsx("p",{className:"flex justify-center mt-14 items-center",children:t.jsx("button",{onClick:_,className:"p-3 px-20 text-white bg-[#8530C1] rounded",children:x||a?t.jsx("p",{className:"flex justify-center items-center",children:t.jsx(ve,{color:"white",size:"sm"})}):t.jsx("span",{className:"text3",children:"Submit"})})})]})]})},Ze=({answers:e})=>{const s=ue(),[r]=X(Z);return t.jsxs("div",{className:"relative flex-grow    w-[780px] rounded-3xl",children:[t.jsx("div",{className:"my-10 text-center",children:t.jsx("h1",{className:"text-[24px] font-bold ",children:"Your Answers"})}),t.jsxs("div",{className:" flex bg-[#FFF7FD] py-10 rounded-3xl    flex-col",children:[e.map((n,i)=>t.jsx(Oe,{...n,index:i})),t.jsx("p",{className:"flex justify-center mt-14 items-center",children:t.jsx("button",{onClick:()=>{s(`/${(r==null?void 0:r.role)==="user"?"parent":"school"}/stories`)},className:"p-3 px-20 text-white bg-[#8530C1] rounded",children:"Done"})})]})]})},be=({question:e,selected_option_value:s,index:r})=>t.jsxs("div",{className:`pt-7 py-5 px-16 ${!s&&"bg-[#ED1C241A]"} `,children:[t.jsxs("p",{className:"flex gap-10 items-center ",children:[t.jsx("p",{className:"text-[#8530C1]  rounded-full p-3 bg-white w-[30px] h-[30px] flex justify-center items-center",children:r+1}),t.jsxs("div",{className:"text-[20px]  w-full flex  justify-between font-semibold ",children:[t.jsx("p",{dangerouslySetInnerHTML:{__html:e}}),t.jsxs("p",{children:[" ",!s&&t.jsx("img",{src:b,alt:"image"})]})]})]}),t.jsx("p",{className:"pl-20 text-[20px] text-[#B5B5C3] py-2",dangerouslySetInnerHTML:{__html:`${s||"-"}`}})]}),Oe=({question:e,selected_option_value:s,index:r,actual_answer:n})=>t.jsxs("div",{className:`pt-7 py-5 px-16 ${s!==n&&"bg-[#ED1C241A]"} `,children:[t.jsxs("p",{className:"flex gap-10 items-center ",children:[t.jsx("p",{className:"text-[#8530C1]  rounded-full p-3 bg-white w-[30px] h-[30px] flex justify-center items-center",children:r+1}),t.jsx("div",{className:"text-[20px]  w-full flex  justify-between font-semibold ",children:t.jsx("p",{dangerouslySetInnerHTML:{__html:e}})}),t.jsx("p",{children:!s||s!==n?t.jsx("img",{src:b,alt:"image"}):t.jsx("img",{src:ye,alt:"iamge"})})]}),s===n&&t.jsx("p",{className:"pl-20 text-[20px] text-[#B5B5C3] py-2",dangerouslySetInnerHTML:{__html:`${s}`}}),s!==n?t.jsxs("div",{children:[t.jsx("p",{className:"pl-16 text-[20px] text-[#B5B5C3] py-2",dangerouslySetInnerHTML:{__html:`${s!==n?s:""}`}}),t.jsx("p",{className:"text-red-500 font=semibold ml-16 flex gap-2 ",dangerouslySetInnerHTML:{__html:` Answer:${n}`}})]}):""]});export{st as default};
