import{r as v,R as l,Q as Pe,j as c,L as re,J as R,M as X,T as we,a as ke,g as Ne,f as Oe,U as Ae,V as Le,X as _e,B as Re,Y as Ie,v as Te}from"./index-7fa67d35.js";import{P as d}from"./index-c42afae0.js";const Be="/assets/paymentPaystack-24e6880f.svg";var H=[];function Me(){var t="https://js.paystack.co/v1/inline.js",e=v.useState({loaded:!1,error:!1}),n=e[0],r=e[1];return v.useEffect(function(){if(H.includes(t))r({loaded:!0,error:!1});else{H.push(t);var a=document.createElement("script");a.src=t,a.async=!0;var o=function(){r({loaded:!0,error:!1})},u=function(){var s=H.indexOf(t);s>=0&&H.splice(s,1),a.remove(),r({loaded:!0,error:!0})};return a.addEventListener("load",o),a.addEventListener("complete",o),a.addEventListener("error",u),document.body.appendChild(a),function(){a.removeEventListener("load",o),a.removeEventListener("error",u)}}},[t]),[n.loaded,n.error]}var Ue=function(t){var e=window.PaystackPop&&window.PaystackPop.setup(t);e&&e.openIframe()};function de(t){var e=Me(),n=e[0],r=e[1],a=t.publicKey,o=t.firstname,u=t.lastname,s=t.phone,i=t.email,S=t.amount,m=t.reference,p=t.metadata,f=p===void 0?{}:p,j=t.currency,P=j===void 0?"NGN":j,E=t.channels,w=t.label,N=w===void 0?"":w,T=t.plan,W=T===void 0?"":T,L=t.quantity,I=L===void 0?"":L,B=t.subaccount,q=B===void 0?"":B,M=t.transaction_charge,G=M===void 0?0:M,O=t.bearer,A=O===void 0?"account":O,_=t.split,F=t.split_code;function U(h,b){if(r)throw new Error("Unable to load paystack inline script");if(n){var C={callback:h||function(){return null},onClose:b||function(){return null},key:a,ref:m,email:i,firstname:o,lastname:u,phone:s,amount:S,currency:P,plan:W,quantity:I,"data-custom-button":t["data-custom-button"]||"",channels:E,subaccount:q,transaction_charge:G,bearer:A,label:N,metadata:f,split:_,split_code:F};Ue(C)}}return v.useEffect(function(){if(r)throw new Error("Unable to load paystack inline script")},[r]),U}var ee=function(){return ee=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},ee.apply(this,arguments)};function me(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n}var pe=v.createContext({initializePayment:function(){return null},onSuccess:function(){return null},onClose:function(){return null}}),ze=function(t){var e=t.children,n=t.onSuccess,r=t.onClose,a=me(t,["children","onSuccess","onClose"]),o=de(a);return l.createElement(pe.Provider,{value:{initializePayment:o,onSuccess:n,onClose:r}},e)},We=function(t){var e=t.children,n=t.ref,r=v.useContext(pe),a=r.initializePayment,o=r.onSuccess,u=r.onClose,s=function(){return a(o,u)};return e({initializePayment:s,ref:n})};v.forwardRef(function(t,e){var n=t.children,r=t.onSuccess,a=t.onClose,o=me(t,["children","onSuccess","onClose"]),u=r||function(){return null},s=a||function(){return null};return l.createElement(ze,ee({},o,{onSuccess:u,onClose:s}),l.createElement(We,{ref:e},n))});const qe="/assets/paymentStripe-6561aed8.svg";var ve="https://js.stripe.com/v3",Ge=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,oe="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",Fe=function(){for(var e=document.querySelectorAll('script[src^="'.concat(ve,'"]')),n=0;n<e.length;n++){var r=e[n];if(Ge.test(r.src))return r}return null},se=function(e){var n=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(ve).concat(n);var a=document.head||document.body;if(!a)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(r),r},Ke=function(e,n){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"2.4.0",startTime:n})},K=null,V=null,Y=null,$e=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},He=function(e,n){return function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}},Ve=function(e){return K!==null?K:(K=new Promise(function(n,r){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe&&e&&console.warn(oe),window.Stripe){n(window.Stripe);return}try{var a=Fe();if(a&&e)console.warn(oe);else if(!a)a=se(e);else if(a&&Y!==null&&V!==null){var o;a.removeEventListener("load",Y),a.removeEventListener("error",V),(o=a.parentNode)===null||o===void 0||o.removeChild(a),a=se(e)}Y=He(n,r),V=$e(r),a.addEventListener("load",Y),a.addEventListener("error",V)}catch(u){r(u);return}}),K.catch(function(n){return K=null,Promise.reject(n)}))},Ye=function(e,n,r){if(e===null)return null;var a=e.apply(void 0,n);return Ke(a,r),a},$,he=!1,ye=function(){return $||($=Ve(null).catch(function(e){return $=null,Promise.reject(e)}),$)};Promise.resolve().then(function(){return ye()}).catch(function(t){he||console.warn(t)});var Je=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];he=!0;var a=Date.now();return ye().then(function(o){return Ye(o,n,a)})};const Xe=({setShowStripe:t,setPaymentType:e,planId:n,setStripeData:r,setStripePromise:a})=>{const{mutate:o,isLoading:u}=Pe(),s=()=>{o({subscription_plan_id:parseInt(n),currency_iso3:"GBP"},{onSuccess(i){var p;r({...i.data.data});const S=(p=i.data.data)==null?void 0:p.public_key,m=Je(S);a(m),R.show({title:"Notification",message:i.data.message}),t(!0),e(!1)},onError(i){R.show({title:"Notification",message:X(i)})}})};return c.jsx("button",{onClick:()=>{s()},className:"flex justify-center items-center border border-customGreen  px-16  py-3 gap-2 rounded-3xl",children:u?c.jsx(re,{size:30,color:"#8530C1"}):c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"text-[16px] font-semibold",children:" pay with "}),c.jsx("img",{src:qe,alt:"image",className:"inline-block"})]})})};function ie(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function ce(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ie(Object(n),!0).forEach(function(r){ge(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function J(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?J=function(e){return typeof e}:J=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(t)}function ge(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Se(t,e){return Qe(t)||Ze(t,e)||De(t,e)||et()}function Qe(t){if(Array.isArray(t))return t}function Ze(t,e){var n=t&&(typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"]);if(n!=null){var r=[],a=!0,o=!1,u,s;try{for(n=n.call(t);!(a=(u=n.next()).done)&&(r.push(u.value),!(e&&r.length===e));a=!0);}catch(i){o=!0,s=i}finally{try{!a&&n.return!=null&&n.return()}finally{if(o)throw s}}return r}}function De(t,e){if(t){if(typeof t=="string")return ue(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ue(t,e)}}function ue(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function et(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var x=function(e,n,r){var a=!!r,o=l.useRef(r);l.useEffect(function(){o.current=r},[r]),l.useEffect(function(){if(!a||!e)return function(){};var u=function(){o.current&&o.current.apply(o,arguments)};return e.on(n,u),function(){e.off(n,u)}},[a,n,e,o])},te=function(e){var n=l.useRef(e);return l.useEffect(function(){n.current=e},[e]),n.current},z=function(e){return e!==null&&J(e)==="object"},tt=function(e){return z(e)&&typeof e.then=="function"},nt=function(e){return z(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},le="[object Object]",rt=function t(e,n){if(!z(e)||!z(n))return e===n;var r=Array.isArray(e),a=Array.isArray(n);if(r!==a)return!1;var o=Object.prototype.toString.call(e)===le,u=Object.prototype.toString.call(n)===le;if(o!==u)return!1;if(!o&&!r)return e===n;var s=Object.keys(e),i=Object.keys(n);if(s.length!==i.length)return!1;for(var S={},m=0;m<s.length;m+=1)S[s[m]]=!0;for(var p=0;p<i.length;p+=1)S[i[p]]=!0;var f=Object.keys(S);if(f.length!==s.length)return!1;var j=e,P=n,E=function(N){return t(j[N],P[N])};return f.every(E)},be=function(e,n,r){return z(e)?Object.keys(e).reduce(function(a,o){var u=!z(n)||!rt(e[o],n[o]);return r.includes(o)?(u&&console.warn("Unsupported prop change: options.".concat(o," is not a mutable property.")),a):u?ce(ce({},a||{}),{},ge({},o,e[o])):a},null):null},Ce="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",fe=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ce;if(e===null||nt(e))return e;throw new Error(n)},at=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ce;if(tt(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(a){return fe(a,n)})};var r=fe(e,n);return r===null?{tag:"empty"}:{tag:"sync",stripe:r}},ot=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"2.7.0"}),e.registerAppInfo({name:"react-stripe-js",version:"2.7.0",url:"https://stripe.com/docs/stripe-js/react"}))},Q=l.createContext(null);Q.displayName="ElementsContext";var xe=function(e,n){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(n," in an <Elements> provider."));return e},Ee=function(e){var n=e.stripe,r=e.options,a=e.children,o=l.useMemo(function(){return at(n)},[n]),u=l.useState(function(){return{stripe:o.tag==="sync"?o.stripe:null,elements:o.tag==="sync"?o.stripe.elements(r):null}}),s=Se(u,2),i=s[0],S=s[1];l.useEffect(function(){var f=!0,j=function(E){S(function(w){return w.stripe?w:{stripe:E,elements:E.elements(r)}})};return o.tag==="async"&&!i.stripe?o.stripePromise.then(function(P){P&&f&&j(P)}):o.tag==="sync"&&!i.stripe&&j(o.stripe),function(){f=!1}},[o,i,r]);var m=te(n);l.useEffect(function(){m!==null&&m!==n&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[m,n]);var p=te(r);return l.useEffect(function(){if(i.elements){var f=be(r,p,["clientSecret","fonts"]);f&&i.elements.update(f)}},[r,p,i.elements]),l.useEffect(function(){ot(i.stripe)},[i.stripe]),l.createElement(Q.Provider,{value:i},a)};Ee.propTypes={stripe:d.any,options:d.object};var st=function(e){var n=l.useContext(Q);return xe(n,e)},it=function(){var e=st("calls useElements()"),n=e.elements;return n};d.func.isRequired;var je=l.createContext(null);je.displayName="CustomCheckoutSdkContext";var ct=function(e,n){if(!e)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(n," in an <CustomCheckoutProvider> provider."));return e},ut=l.createContext(null);ut.displayName="CustomCheckoutContext";d.any,d.shape({clientSecret:d.string.isRequired,elementsOptions:d.object}).isRequired;var ne=function(e){var n=l.useContext(je),r=l.useContext(Q);if(n&&r)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CustomCheckoutProvider> and <Elements> providers."));return n?ct(n,e):xe(r,e)},lt=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},y=function(e,n){var r="".concat(lt(e),"Element"),a=function(i){var S=i.id,m=i.className,p=i.options,f=p===void 0?{}:p,j=i.onBlur,P=i.onFocus,E=i.onReady,w=i.onChange,N=i.onEscape,T=i.onClick,W=i.onLoadError,L=i.onLoaderStart,I=i.onNetworksChange,B=i.onConfirm,q=i.onCancel,M=i.onShippingAddressChange,G=i.onShippingRateChange,O=ne("mounts <".concat(r,">")),A="elements"in O?O.elements:null,_="customCheckoutSdk"in O?O.customCheckoutSdk:null,F=l.useState(null),U=Se(F,2),h=U[0],b=U[1],C=l.useRef(null),Z=l.useRef(null);x(h,"blur",j),x(h,"focus",P),x(h,"escape",N),x(h,"click",T),x(h,"loaderror",W),x(h,"loaderstart",L),x(h,"networkschange",I),x(h,"confirm",B),x(h,"cancel",q),x(h,"shippingaddresschange",M),x(h,"shippingratechange",G),x(h,"change",w);var D;E&&(e==="expressCheckout"?D=E:D=function(){E(h)}),x(h,"ready",D),l.useLayoutEffect(function(){if(C.current===null&&Z.current!==null&&(A||_)){var k=null;_?k=_.createElement(e,f):A&&(k=A.create(e,f)),C.current=k,b(k),k&&k.mount(Z.current)}},[A,_,f]);var ae=te(f);return l.useEffect(function(){if(C.current){var k=be(f,ae,["paymentRequest"]);k&&C.current.update(k)}},[f,ae]),l.useLayoutEffect(function(){return function(){if(C.current&&typeof C.current.destroy=="function")try{C.current.destroy(),C.current=null}catch{}}},[]),l.createElement("div",{id:S,className:m,ref:Z})},o=function(i){ne("mounts <".concat(r,">"));var S=i.id,m=i.className;return l.createElement("div",{id:S,className:m})},u=n?o:a;return u.propTypes={id:d.string,className:d.string,onChange:d.func,onBlur:d.func,onFocus:d.func,onReady:d.func,onEscape:d.func,onClick:d.func,onLoadError:d.func,onLoaderStart:d.func,onNetworksChange:d.func,onConfirm:d.func,onCancel:d.func,onShippingAddressChange:d.func,onShippingRateChange:d.func,options:d.object},u.displayName=r,u.__elementType=e,u},g=typeof window>"u",ft=l.createContext(null);ft.displayName="EmbeddedCheckoutProviderContext";var dt=function(){var e=ne("calls useStripe()"),n=e.stripe;return n};y("auBankAccount",g);y("card",g);y("cardNumber",g);y("cardExpiry",g);y("cardCvc",g);y("fpxBank",g);y("iban",g);y("idealBank",g);y("p24Bank",g);y("epsBank",g);var mt=y("payment",g);y("expressCheckout",g);y("paymentRequestButton",g);var pt=y("linkAuthentication",g);y("address",g);y("shippingAddress",g);y("paymentMethodMessaging",g);y("affirmMessage",g);y("afterpayClearpayMessage",g);const vt=({setIsElementLoading:t})=>{const e=dt(),n=it(),[r,a]=v.useState(""),o=async m=>{if(m.preventDefault(),!e||!n)return;s(!0);const{error:p}=await n.submit();if(p){a(p.message);return}try{const{error:f}=await e.confirmPayment({elements:n,confirmParams:{return_url:`${window.location.origin}/congratulations`}});f?a(f.message):R.show({title:"Notification",message:"Payment Successful"})}catch(f){R.show({title:"Notification",message:X(f)})}s(!1)},[u,s]=v.useState(!1),[i,S]=v.useState(!1);return c.jsxs("form",{className:"strip-form",onSubmit:o,children:[c.jsx(pt,{id:"link-authentication-element"}),c.jsx(mt,{onChange:m=>{m.complete&&S(!0)},onReady:()=>{t(!1)},id:"payment-element",options:{layout:"tabs"}}),c.jsx("button",{className:"w-[120px] bg-customGreen rounded flex justify-center items-center py-2",disabled:u||!e||!n||!i,id:"submit",children:c.jsx("span",{id:"button-text ",className:" rounded  text-white",children:u?c.jsx(re,{size:20,color:"white"}):c.jsx("span",{className:"text-center",children:"Pay now"})})}),r&&c.jsx("div",{children:r})]})},ht=({stripeData:t,stripePromise:e})=>{const[n,r]=v.useState(!1);return c.jsx(we,{height:400,visible:n,children:c.jsx(c.Fragment,{children:e?c.jsx(Ee,{stripe:e,options:{clientSecret:t==null?void 0:t.clientSecret},children:t?c.jsx(vt,{setIsElementLoading:r}):null}):null})})},yt={transaction_reference:"",email:"",amount:0,public_key:"",access_code:""},gt=()=>{const[t]=ke(Ne),e=sessionStorage.getItem("planId"),n=sessionStorage.getItem("currency_iso3"),r=Oe(),{mutate:a}=Ae(),{mutate:o,isLoading:u}=Le(),[s,i]=v.useState(yt),[S,m]=v.useState(),[p,f]=v.useState(),[j,P]=v.useState(!1),E=()=>{P(!0),o({subscription_plan_id:Number(e)},{onSuccess(b){i({...b.data.data})},onError(b){R.show({title:"Notification",message:X(b)})}})},[w,N]=v.useState(!1),T={reference:s==null?void 0:s.transaction_reference,email:s==null?void 0:s.email,amount:s==null?void 0:s.amount,publicKey:s==null?void 0:s.public_key},W=de(T);function L(b){return b<10?"0"+b:b}const I=new Date,B=I.getHours(),q=I.getMinutes(),M=I.getSeconds(),G=L(B)+":"+L(q)+":"+L(M);v.useEffect(()=>{const b=s;!w&&(b!=null&&b.transaction_reference)&&b.amount&&(N(!0),W(()=>{N(!1),a({reference:s==null?void 0:s.transaction_reference},{onSuccess(C){_e.track_event("web_subscribed",{user_id:t==null?void 0:t.user_id,subsription_plan:"annual",date:G,amount:s==null?void 0:s.amount,currency:n==="NG"?"NGN":n==="UK"?"GBP":"USD"}),r("/congratulations"),R.show({title:"Notification",message:C.data.message})},onError(C){R.show({title:"Notification",message:X(C)})}})},()=>{N(!1),R.show({message:"Plan payment canceled",title:"Notification"})}))},[s]);const[O,A]=v.useState(!0),[_,F]=v.useState(!1),[U,h]=v.useState(!1);return c.jsx(c.Fragment,{children:c.jsx("div",{className:"flex justify-center items-center rounded-[50px]py-4 w-full h-full",children:c.jsxs("div",{className:" bg-white w-[50%] h-full  relative  rounded-2xl   ",children:[c.jsx("button",{onClick:()=>{r(-1)},children:c.jsx("span",{className:"absolute right-[-150px] top-[80px]"})}),c.jsxs("div",{className:"w-[100%]  my-auto ",children:[c.jsx("span",{}),c.jsx("h1",{className:"  font-semibold header2 font-BalooSemiBold text-center",children:"Make payment"}),c.jsx("p",{className:"text-[15px] text-center  text-[#A7A7A7] font-Hanken",children:"Kindly complete your payment using a valid credit card."}),e&&O&&c.jsxs("div",{className:"flex gap-10 justify-center items-center mt-10 ",children:[c.jsx(Xe,{currencyIso3:n,planId:e,setStripeData:m,setStripePromise:f,setShowStripe:F,setPaymentType:A}),c.jsxs("button",{onClick:()=>{h(!0),A(!1)},className:"flex justify-center items-center border border-customGreen  px-8  py-3 gap-2 rounded-3xl",children:[c.jsx("span",{className:"text-[16px] font-semibold",children:" pay with "}),c.jsx("img",{src:Be,alt:"image",className:"inline-block"})]})]}),U&&c.jsx("p",{className:"mt-10 px-40 flex justify-center items-center",children:c.jsx(Re,{disable:j,onClick:E,size:"full",children:u||w?c.jsx("p",{className:"flex justify-center items-center",children:c.jsx(re,{color:"white",size:"sm"})}):c.jsx("span",{children:"Pay now"})})}),e&&_&&c.jsx("p",{className:"mt-10 flex items-center justify-center",children:c.jsx(ht,{stripeData:S,stripePromise:p})})]})]})})})},Ct=()=>(v.useState(Ie),sessionStorage.getItem("gotToHome"),c.jsx("div",{style:{backgroundImage:`url(${Te})`,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",height:"100vh",width:"100%"},className:"py-4",children:c.jsx(gt,{})}));export{Ct as default};
